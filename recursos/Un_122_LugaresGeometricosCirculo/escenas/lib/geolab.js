var canvas,context,descartes,WIDTH,HEIGHT,xIzquierda,xDerecha,yArriba,yAbajo,coords,offsetIzquierdo,offsetDerecho,factorX,factorY,recta01,objSelec,objetoActual,mensaje,nota,ambiente,map,mensajeTouch="",linea="",touch=!1,retardoDescartes=0,enGrados=!0,modificado=!1,pasos=100,limiteMaximo=1e3,limiteMinimo=-1e3,xMinimo=-10,yMinimo=-10,xMaximo=10,yMaximo=10,dragok=!1,dedo=30,respuesta="",listaObjetos=new Array,constructores=new Array,cos=new Array,sen=new Array,tan=new Array,x="",showInfo=!1;function init(){descartes=new Array,document.multitouchData=!0,canvas=document.getElementById("pizarron"),context=canvas.getContext("2d"),coords=relMouseCoords(canvas),canvasX=coords.x,canvasY=coords.y,WIDTH=canvas.width,HEIGHT=canvas.height;for(var t=0;t<pasos;t++)cos[t]=Math.cos(2*t*Math.PI/pasos),sen[t]=Math.sin(2*t*Math.PI/pasos),tan[t]=sen[t]/cos[t];return canvas.addEventListener("touchstart",myMtDown,!1),canvas.addEventListener("touchmove",myMtMove,!1),canvas.addEventListener("touchend",myMtUp,!1),canvas.addEventListener("mousemove",myMove,!1),canvas.addEventListener("mousedown",myDown,!1),canvas.addEventListener("mouseup",myUp,!1),window.addEventListener("message",funcionQueManejaLosMensajes),map=new Map,ongoingTouches=new Array,lee(),limites(0,WIDTH,xMinimo,xMaximo,HEIGHT,0,yMinimo,yMaximo),conectaComplejos(listaObjetos),recalculaTodo(),escribeParametros(),document.getElementById("pizarron").innerHTML=respuesta,draw(),setInterval(draw,1e4)}function lee(){x="";for(var t=document.getElementsByTagName("nota"),e=0;e<t.length;e++)(nota=new Nota).memoria=t[e].getAttribute("texto");var a=document.getElementsByTagName("ambiente");ambiente=new Ambiente;for(e=0;e<a.length;e++){if(null!=(h=a[e].getAttribute("ventana"))){var i=h.split(",");xMinimo=1*i[0],yMinimo=1*i[1],xMaximo=1*i[2],yMaximo=1*i[3]}ambiente.decimales=1*a[e].getAttribute("decimales"),ambiente.enRejilla=1*a[e].getAttribute("enRejilla"),ambiente.ejes=1*a[e].getAttribute("conEjes");var o=a[e].getAttribute("colorFondo");null!=o&&(ambiente.color=calculaColor(o));var r=a[e].getAttribute("colorEjes");null!=r&&(ambiente.colorEjes=calculaColor(r))}var s=document.getElementsByTagName("objeto"),n=!1;for(e=0;e<s.length;e++){switch(s[e].getAttribute("tipo")){case"escalar":listaObjetos[e]=new Escalar;break;case"punto":listaObjetos[e]=new Punto;break;case"recta":listaObjetos[e]=new Recta;break;case"circulo":listaObjetos[e]=new Circulo;break;case"conica":listaObjetos[e]=new Conica;break;case"arco":case"angulo":listaObjetos[e]=new Angulo;break;case"poligono":listaObjetos[e]=new Poligono;break;case"condicion":listaObjetos[e]=new Condicion;break;case"medidaAngulo":listaObjetos[e]=new MedidaAngulo;break;case"grafica":listaObjetos[e]=new Grafica;break;case"funcionRigida":listaObjetos[e]=new FuncionRigida;break;case"funcionSemejanza":listaObjetos[e]=new FuncionSemejanza;break;default:n=!0,x="Objeto tipo "+s[e].getAttribute("tipo")+" no definido <br>"}if(1==n)return void(mensaje=x);listaObjetos[e].tConstructor=1*s[e].getAttribute("constructor"),listaObjetos[e].nombre=s[e].getAttribute("nombre"),mensaje=s[e].getAttribute("tipo")+"  "+s[e].getAttribute("nombre"),x+=mensaje;var h,c=s[e].getAttribute("color");if(null!=c){i=c.split(",");for(var p=0;p<i.length;p++)listaObjetos[e].color[p]=calculaColor(i[p])}if(null!=(h=s[e].getAttribute("visible")))for(i=h.split(","),p=0;p<i.length;p++)listaObjetos[e].visible[p]=1*i[p];var u=s[e].getAttribute("ancho");if(null!=u)for(i=u.split(","),p=0;p<i.length;p++)listaObjetos[e].ancho[p]=1*i[p];var l=s[e].getAttribute("parametros");if(null!=l){for(i=l.split(","),p=0;p<i.length;p++)listaObjetos[e].parametros[p]=1*i[p];x=x+" parametros: "+listaObjetos[e].parametros+"<br>"}var m=s[e].getAttribute("objRef");if(null!=m){for(i=m.split(","),p=0;p<i.length;p++)listaObjetos[e].referencias[p]=1*i[p];x=x+" referencias: "+i+"<br>"}var b=s[e].getAttribute("etiqueta");if(null!=b){i=b.split(",");listaObjetos[e].miEtiqueta=new Etiqueta,listaObjetos[e].miEtiqueta.visible=1*i[0],listaObjetos[e].miEtiqueta.ancla=1*i[1]}var f=s[e].getAttribute("formulas");if(null!=f){listaObjetos[e].claseCompleja=TC_Polaca,listaObjetos[e].datoFormula=new TFormulas,listaObjetos[e].datoFormula.arrPolacas=new Array;for(i=f.split(";"),p=0;p<i.length;p++)polaca=new TPolaca,polaca.formula=i[p].trim(),listaObjetos[e].datoFormula.arrPolacas.push(polaca);x=x+" formulas: "+i+"<br>"}var E=s[e].getAttribute("importa");if(null!=E){i=E.split(",");listaObjetos[e].importa=new Array;for(p=0;p<i.length;p++)listaObjetos[e].importa[p]=1*i[p]}var j=s[e].getAttribute("exporta");if(null!=j){i=j.split(",");listaObjetos[e].exporta=new Array;for(p=0;p<i.length;p++)listaObjetos[e].exporta[p]=i[p]}mensaje="Nombre: "+listaObjetos[e].nombre+" tipo: "+listaObjetos[e].tipo+" Parametros: "+listaObjetos[e].parametros,x=x+mensaje+"<br>"}for(e=0;e<listaObjetos.length;e++)for(p=0;p<listaObjetos[e].referencias.length;p++)listaObjetos[e].objRef[p]=listaObjetos[1*listaObjetos[e].referencias[p]];for(e=0;e<listaObjetos.length;e++)eligeConstructor(listaObjetos[e]);null!=nota&&nota.procesaNota(),x=x+"Num objetos "+listaObjetos.length+"<br>",respuesta=x,escribeParametros()}function calculaColor(t){return 7==t.length?"#"+t.substr(5,2)+t.substr(3,2)+t.substr(1,2):5==t.length?"#"+t.substr(3,2)+t.substr(1,2)+"00":3==t.length?"#"+t.substr(1,2)+"00"+"00":"#0"==t?"#"+"00"+"00"+"00":t}function rect(t,e,a,i){context.beginPath(),context.rect(t,e,a,i),context.closePath(),context.fill()}function llenaCirculo(t,e,a,i){context.fillStyle=t,context.beginPath(),context.arc(e,a,i,0,2*Math.PI,!0),context.closePath(),context.fill()}function pintaCirculo(t,e,a,i,o){context.strokeStyle=t,context.lineWidth=e,context.beginPath(),context.arc(a,i,o,0,2*Math.PI,!0),context.closePath(),context.stroke()}function pintaArco(t,e,a,i,o,r,s,n){context.beginPath(),context.strokeStyle=t,context.lineWidth=e,context.arc(a,i,o,-r,-s,n),context.stroke()}function llenaArco(t,e,a,i,o,r,s,n){context.fillStyle=t,context.lineWidth=e,context.arc(a,i,o,-r,-s,n),context.fill()}function dibujaSegmento(t,e,a,i){context.strokeStyle=t,context.lineWidth=e,context.globalAlpha=0,context.beginPath(),context.moveTo(a[0],a[1]),context.lineTo(i[0],i[1]),context.closePath(),context.stroke()}function dibujaPoligono(t,e,a,i){context.strokeStyle=t,context.lineWidth=e,context.beginPath(),context.moveTo(a[0],i[0]);for(var o=0;o<a.length;o++)context.lineTo(a[o],i[o]);context.closePath(),context.stroke()}function dibujaPoligonoAbierto(t,e,a,i){context.beginPath(),context.strokeStyle=t,context.lineWidth=e,context.moveTo(a[0],i[0]);for(var o=0;o<a.length-1;o++)context.lineTo(a[o],i[o]);context.stroke()}function dibujaEjes(){segmento(ambiente.colorEjes,.5,cambiaX(xMinimo),cambiaY(0),cambiaX(xMaximo),cambiaY(0)),segmento(ambiente.colorEjes,.5,cambiaX(0),cambiaY(yMinimo),cambiaX(0),cambiaY(yMaximo)),context.fillStyle="Grey",context.font="9px Arial";for(var t=Math.floor(xMinimo);t<Math.ceil(xMaximo)+1;t++)segmento(ambiente.colorEjes,.2,cambiaX(t),cambiaY(0),cambiaX(t),cambiaY(0)+5),context.fillText(t,cambiaX(t)-3,cambiaY(0)+15);for(t=Math.floor(yMinimo);t<Math.ceil(yMaximo)+1;t++)segmento(ambiente.colorEjes,.2,cambiaX(0),cambiaY(t),cambiaX(0)-5,cambiaY(t)),0!=t&&context.fillText(t,cambiaX(0)-14,cambiaY(t)+2);context.strokeStyle=ambiente.colorEjes}function segmento(t,e,a,i,o,r){context.beginPath(),context.strokeStyle=t,context.lineWidth=e,context.moveTo(a,i),context.lineTo(o,r),context.closePath(),context.stroke()}function rellenaPoligono(t,e,a){context.fillStyle=t,context.globalAlpha=.3,context.beginPath(),context.moveTo(e[0],a[0]);for(var i=0;i<e.length;i++)context.lineTo(e[i],a[i]);context.closePath(),context.fill(),context.globalAlpha=1}function dibujaRectaGeneral(t,e,a){context.strokeStyle=t,context.lineWidth=e,context.beginPath(),Math.abs(a[1])<epsilon?0!=a[0]&&(context.moveTo(cambiaX(-a[2]/a[0]),cambiaY(yMinimo)),context.lineTo(cambiaX(-a[2]/a[0]),cambiaY(yMaximo))):(context.moveTo(cambiaX(xMinimo),cambiaY((-a[0]*xMinimo-a[2])/a[1])),context.lineTo(cambiaX(xMaximo),cambiaY((-a[0]*xMaximo-a[2])/a[1]))),context.closePath(),context.stroke()}function escribePolinomio(t,e){for(var a="",i=!0,o="",r="",s=0;s<t.length;s++)Math.abs(t[s])>epsilon&&(o=t[s]<0?" - ":i?"":" + ",i=!1,s<t.length-1?r=Math.abs(Math.abs(t[s])-1)<epsilon?"":Math.abs(t[s]).toFixed(ambiente.decimales):s==t.length-1&&(Math.abs(t[s])>epsilon?r=Math.abs(t[s]).toFixed(ambiente.decimales):(r="",o="")),a=a+o+r+e[s]);return""==a?"Polinomio cero":a}function clear(){context.clearRect(0,0,WIDTH,HEIGHT)}function draw(){clear(),context.globalAlpha=.2,context.fillStyle=ambiente.color,context.globalAlpha=1,context.font="16px Arial",rect(0,0,WIDTH,HEIGHT),ambiente.ejes&&dibujaEjes();for(var t=0;t<listaObjetos.length;t++)listaObjetos[t].rellena(),listaObjetos[t].dibuja()}function myMove(t){var e,a;if(!touch)try{t.preventDefault(),null!=objSelec&&(e=t.pageX,a=t.pageY,arrastra(objSelec,e,a)),t.preventDefault()}catch(t){}}function myDown(t){try{var e,a,i,o;t.preventDefault(),objSelec=null;var r=t.pageX,s=t.pageY;pintaCirculo("#aaa",1,r-canvasX,s-canvasY,10);for(var n=0;n<listaObjetos.length;n++)listaObjetos[n].arrastrable&&(0,a=cambiaX(listaObjetos[n].parametros[0])+dedo+canvasX,e=cambiaX(listaObjetos[n].parametros[0])-dedo+canvasX,i=cambiaY(listaObjetos[n].parametros[1])+dedo+canvasY,o=cambiaY(listaObjetos[n].parametros[1])-dedo+canvasY,r<a&&r>e&&s<i&&s>o&&(modificado=!0,objSelec=listaObjetos[n]));null!=objSelec&&(dragok=!0,modificado=!0)}catch(t){}}function myUp(t){dragok=!1,objSelec=null}function myMtDown(t){try{t.preventDefault();for(var e=t.changedTouches,a=0;a<e.length;a++){var i,o,r,s,n=e[a].pageX,h=e[a].pageY;pintaCirculo("#aaa",1,n-canvasX,h-canvasY,10);for(var c=0;c<listaObjetos.length;c++)listaObjetos[c].arrastrable&&(0,o=cambiaX(listaObjetos[c].parametros[0])+dedo+canvasX,i=cambiaX(listaObjetos[c].parametros[0])-dedo+canvasX,r=cambiaY(listaObjetos[c].parametros[1])+dedo+canvasY,s=cambiaY(listaObjetos[c].parametros[1])-dedo+canvasY,n<o&&n>i&&h<r&&h>s&&map.put(e[a].identifier,c))}}catch(t){}}function myMtMove(t){t.preventDefault();try{for(var e=t.changedTouches,a=0;a<e.length;a++)if(null!=map.get(e[a].identifier)){objSelec=listaObjetos[map.get(e[a].identifier)];var i=e[a].pageX,o=e[a].pageY;arrastra(objSelec,i,o)}}catch(t){}}function myMtUp(t){touch=!0,t.preventDefault();for(var e=t.changedTouches,a=0;a<e.length;a++)map.remove(e[a].identifier)}function arrastra(t,e,a){switch(t.tConstructor){case 0:t.parametros[0]=cambiaXinv(e-canvasX),t.parametros[1]=cambiaYinv(a-canvasY),ambiente.enRejilla&&(t.parametros[0]=Math.round(t.parametros[0]),t.parametros[1]=Math.round(t.parametros[1]));break;case 6:var i=new Array;i[0]=cambiaXinv(e-canvasX),i[1]=cambiaYinv(a-canvasY);var o=new Array;rectaDosPuntosSinNormalizar(o,t.objRef[0].parametros,t.objRef[1].parametros);var r=new Array;puntoProyeccionRecta(r,i,o),t.parametros[0]=r[0],t.parametros[1]=r[1],ambiente.enRejilla&&(t.parametros[0]=Math.round(t.parametros[0]),t.parametros[1]=Math.round(t.parametros[1])),calculaRazon(t);break;case 7:t.parametros[0]=cambiaXinv(e-canvasX),t.parametros[1]=cambiaYinv(a-canvasY),ambiente.enRejilla&&(t.parametros[0]=Math.round(t.parametros[0]),t.parametros[1]=Math.round(t.parametros[1])),t.puntoEnCirculo();break;case 28:t.parametros[0]=cambiaXinv(e-canvasX),t.parametros[1]=cambiaYinv(a-canvasY),ambiente.enRejilla&&(t.parametros[0]=Math.round(t.parametros[0]),t.parametros[1]=Math.round(t.parametros[1])),t.puntoEnRecta()}modificado=!0,recalculaTodo(),escribeParametros()}function relMouseCoords(t){var e=0,a=0,i=t;do{linea=linea+"-"+i.offsetLeft,e+=i.offsetLeft,a+=i.offsetTop}while(i=i.offsetParent);return{x:e,y:a}}function funcionQueManejaLosMensajes(t){var e=t.data,a=0;"set"===e.type?(a=1*e.name,descartes[a]=e.value):"update"===e.type&&recalculaTodo()}function Ambiente(){this.decimales=2,this.enRejilla=0,this.color="#d0e8ff",this.ejes=0,this.colorEjes="#aaaaaa",this.ventana=Array()}function ObjetoBasico(){this.nombre="",this.descripcion="",this.parametros=Array(),this.paramDir=Array(),this.numParam=0,this.numParamDir=0,this.esVerdadero=!1,this.offset=Array(),this.referencias=Array(),this.objRef,this.tConstructor="0",this.calcular=!1,this.defDirecta=!1,this.existe=0,this.tipo=0,this.tipoTransf=0,this.claseCompleja=0,this.datoFormula,this.memo,this.miEtiqueta,this.importa,this.exporta,ObjetoBasico.prototype.ponparametros=function(){},ObjetoBasico.prototype.objetoCalculado=function(){this.existe=TE_NoExiste;for(var t=0;t<this.datoFormula.arrPolacas.length;t++)this.parametros[t]=this.datoFormula.arrPolacas[t].Evalua();if(0==this.tipo&&(this.parametros[2]=1),1==this.tipo&&arreglaRecta(this.parametros,this.parametros)&&(this.existe=TE_Existe),3==this.tipo){this.parametros[1]=this.parametros[1]/2,this.parametros[3]=this.parametros[3]/2,this.parametros[4]=this.parametros[4]/2,this.copiaParametrosDirectos();var e=this.parametros;completaConica(e),analizaConica(this,e),this.existe=TE_Existe}else this.existe=TE_Existe;return this.existe}}function ObjetoGeometrico(){this.seleccionado=!1,this.flashear=!1,this.vCondicional=!1,this.arrastrable=!1,this.traza=!1,this.tDibujo=0,this.paginas=0,this.tEntrada=0,this.numNiveles=0,this.nivelOriginal=0,this.tag=0,this.numComponentes=0,this.indice=0,this.tFijo=0,this.numGra=0,this.indiceObj=0,this.indiceGra=0,this.color=Array(),this.visible=Array(),this.ancho=Array(),this.nivel=Array(),this.tipoLinea=Array(),this.visible=Array(),this.elementoGrafico=Array(),ObjetoGeometrico.prototype.dibuja=function(){},ObjetoGeometrico.prototype.rellena=function(){},ObjetoGeometrico.prototype.ponEtiqueta=function(t,e,a){context.fillStyle="#000",context.font="italic bold 19px descartesJS_serif",context.fillText(t,e,a)},ObjetoGeometrico.prototype.copiaParametrosDirectos=function(){for(var t=0;t<this.numParamDir;t++)this.paramDir[t]=this.parametros[t]}}function MedidaAngulo(){this.parametros=new Array,this.objRef=new Array,this.visible=new Array,MedidaAngulo.prototype.ponConstantes=function(){this.numComponentes=1,this.tipo=TipoMedidaAngulo,this.visible[0]=0,this.traza=!1},this.ponConstantes(),MedidaAngulo.prototype.ponparametros=function(t){this.parametros[0]=t},MedidaAngulo.prototype.dibuja=function(){var t;null!=this.miEtiqueta&&null!=this.miEtiqueta.ancla&&(t=enGrados?180*this.parametros[0]/Math.PI:this.parametros[0],listaObjetos[this.miEtiqueta.ancla].mandaEtiqueta(t.toFixed(ambiente.decimales)))},MedidaAngulo.prototype.rellena=function(){}}function Escalar(){this.parametros=new Array,this.numParam=1,this.objRef=new Array,this.referencias=new Array,Escalar.prototype.ponConstantes=function(){this.tipo=TipoEscalar,this.existe=TE_Existe},this.ponConstantes(),Escalar.prototype.ponparametros=function(t){this.parametros[0]=t},Escalar.prototype.escalarDirecto=function(){},Escalar.prototype.dibuja=function(){null!=this.miEtiqueta&&null!=this.miEtiqueta.ancla&&this.miEtiqueta.ancla>-1&&listaObjetos[this.miEtiqueta.ancla].visible[0]>0&&listaObjetos[this.miEtiqueta.ancla].mandaEtiqueta(this.parametros[0].toFixed(ambiente.decimales))},Escalar.prototype.rellena=function(){},Escalar.prototype.escalarDistanciaDosPuntos=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return this.existe=TE_Existe,this.parametros[0]=hipotenusa(this.objRef[1].parametros[0]-this.objRef[0].parametros[0],this.objRef[1].parametros[1]-this.objRef[0].parametros[1]),this.copiaParametrosDirectos(),!0},Escalar.prototype.escalarDistanciaPuntoRecta=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e,a,i,o,r;return e=this.objRef[0].parametros[0],a=this.objRef[0].parametros[1],i=this.objRef[1].parametros[0],o=this.objRef[1].parametros[1],r=this.objRef[1].parametros[2],this.existe=TE_Existe,this.parametros[0]=i*e+o*a+r,this.copiaParametrosDirectos(),!0},Escalar.prototype.escalarPotencia=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!escalarPotencia(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Escalar.prototype.escalarDivisionSegmento=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!escalarDivisionSegmento(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Escalar.prototype.escalarRazonCruzadaPuntos=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.parametros,a=this.objRef[0].parametros,i=this.objRef[1].parametros,o=this.objRef[2].parametros,r=this.objRef[3].parametros,s=(i[0]-o[0])*(r[0]-a[0]);if(Math.abs(s)>epsilon)e[0]=(o[0]-a[0])*(i[0]-r[0])/s;else{if(s=(i[1]-o[1])*(r[1]-a[1]),!(Math.abs(s)>epsilon))return!1;e[0]=(o[1]-a[1])*(i[1]-r[1])/s}return this.existe=TE_Existe,!0},Escalar.prototype.escalarPerimetroPoligono=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return this.parametros[0]=this.objRef[0].perimetroPoligono(),this.existe=TE_Existe,!0},Escalar.prototype.escalarAreaPoligono=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return this.parametros[0]=this.objRef[0].areaPoligono(),this.existe=TE_Existe,!0},Escalar.prototype.escalarSemiEjeFocal=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0];return e.central?this.parametros[0]=e.a:9==e.tipoConica&&(this.parametros[0]=e.p),this.existe=TE_Existe,!0},Escalar.prototype.escalarSemiEjeConjugado=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0];if(e.central)return this.parametros[0]=e.b,this.existe=TE_Existe,!0},Escalar.prototype.escalarSemiDistanciaFocal=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0];if(e.central)return this.parametros[0]=e.c,this.existe=TE_Existe,!0},Escalar.prototype.escalarExcentricidad=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0];if(e.central)return this.parametros[0]=e.e,this.existe=TE_Existe,!0},Escalar.prototype.mandaEtiqueta=function(t){null!=this.miEtiqueta&&null!=this.miEtiqueta.ancla&&listaObjetos[this.miEtiqueta.ancla].mandaEtiqueta(this.parametros[0].toFixed(ambiente.decimales))},Escalar.prototype.escalarRazonCruzadaRectas=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.parametros,a=this.objRef[0].parametros,i=this.objRef[0].parametros,o=this.objRef[0].parametros,r=this.objRef[0].parametros,s=(i[2]*o[0]-i[0]*o[2])*(a[0]*r[2]-a[2]*r[0]);return Math.abs(s)>epsilon?e[0]=(a[0]*o[2]-a[2]*o[0])*(i[2]*r[0]-i[0]*r[2])/s:s=(i[2]*o[1]-i[1]*o[2])*(a[1]*r[2]-a[2]*r[1]),Math.abs(s)>epsilon&&(e[0]=(a[1]*o[2]-a[2]*o[1])*(i[2]*r[1]-i[1]*r[2])/s,this.existe=TE_Existe,!0)}}function Condicion(){this.parametros=new Array,this.objRef=new Array,this.referencias=new Array,this.visible=new Array,Condicion.prototype.ponConstantes=function(){this.numComponentes=1,this.tipo=TipoCondicion,this.visible[0]=0,this.traza=!1},this.ponConstantes(),Condicion.prototype.dibuja=function(){null!=this.miEtiqueta&&null!=this.miEtiqueta.ancla&&listaObjetos[this.miEtiqueta.ancla].mandaEtiqueta(this.parametros[0])},Condicion.prototype.rellena=function(){},Condicion.prototype.condicionOrientado=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return this.objRef[0].areaPoligono()>=0?this.parametros[0]=1:this.parametros[0]=0,this.esVerdadero=this.parametros[0],this.existe=TE_Existe,!0}}function Punto(){this.parametros=new Array,this.color=new Array,this.ancho=new Array,this.objRef=new Array,this.referencias=new Array,this.visible=new Array,this.miEtiqueta=new Etiqueta,Punto.prototype.ponparametros=function(t,e){this.parametros[0]=t,this.parametros[1]=e,this.parametros[2]=1},Punto.prototype.ponConstantes=function(){this.tipo=TipoPunto,this.lambda=0,this.tipo=0,this.numParam=3,this.numParamDir=2,this.numComponentes=1,this.nivel[0]=1,this.color[0]="#0000ff",this.color[1]="#ff0000",this.ancho[0]=1,this.tipoLinea[0]=1,this.visible[0]=1,this.traza=!1,this.r=1,this.existe=TE_Existe,this.miEtiqueta.visible=2,this.ponparametros(0,0)},this.ponConstantes(),Punto.prototype.dibuja=function(){if(this.existe==TE_Existe&&1==this.visible[0]&&(pintaCirculo(this.color[0],1,cambiaX(this.parametros[0]),cambiaY(this.parametros[1]),this.r*this.ancho[0]),llenaCirculo(this.color[1],cambiaX(this.parametros[0]),cambiaY(this.parametros[1]),this.r*this.ancho[0]),null!=this.miEtiqueta))switch(this.miEtiqueta.visible){case 0:break;case 2:this.mandaEtiqueta(this.nombre);break;case 1:this.mandaEtiqueta(this.nombre+"("+this.parametros[0].toFixed(ambiente.decimales)+", "+this.parametros[1].toFixed(ambiente.decimales)+")")}},Punto.prototype.rellena=function(){},Punto.prototype.mandaEtiqueta=function(t){this.ponEtiqueta(t,cambiaX(this.parametros[0])+10,cambiaY(this.parametros[1])+10)},Punto.prototype.puntoDirecto=function(){this.parametros[2]=1,this.arrastrable=!0,this.existe=TE_Existe},Punto.prototype.puntoProyeccionRecta=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!puntoProyeccionRecta(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(this.existe=TE_Existe,this.parametros[2]=1,this.copiaParametrosDirectos(),!0)},Punto.prototype.puntoInterseccionRectas=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return puntoInterseccionRectas(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)?this.existe=TE_Existe:this.existe=TE_Proyectivo,this.copiaParametrosDirectos(),!0},Punto.prototype.puntoMedio=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!puntoMedio(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(this.existe=TE_Existe,this.parametros[2]=1,this.copiaParametrosDirectos(),!0)},Punto.prototype.puntoDivisionSegmento=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!puntoDivisionSegmento(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Punto.prototype.puntoEnSegmento=function(){this.existe=TE_NoExiste;for(var t=new Array,e=new Array,a=new Array,i=0;i<this.objRef.length;i++)if(this.objRef[i].existe==TE_NoExiste)return!1;return t=this.objRef[0].parametros,e=this.objRef[1].parametros,this.parametros.length<5?a[0]=a[1]=1:(a[0]=this.parametros[3],a[1]=this.parametros[4],a[0]+a[1]==0&&(a[0]=a[1]=1)),this.parametros[0]=(a[0]*t[0]+a[1]*e[0])/(a[0]+a[1]),this.parametros[1]=(a[0]*t[1]+a[1]*e[1])/(a[0]+a[1]),this.parametros[2]=1,this.existe=TE_Existe,this.copiaParametrosDirectos(),this.arrastrable=!0,!0},Punto.prototype.puntoEnCirculo=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e,a=new Array,i=new Array;return i=this.objRef[0].parametros,e=hipotenusa((a=this.parametros)[0]-i[0],a[1]-i[1]),Math.abs(e)<epsilon?(a[0]=i[0]+i[2],a[1]=i[1]+i[2]):(e=i[2]/e,a[0]=i[0]+e*(a[0]-i[0]),a[1]=i[1]+e*(a[1]-i[1])),this.existe=TE_Existe,this.parametros[2]=1,this.arrastrable=!0,this.copiaParametrosDirectos(),!0},Punto.prototype.puntoInterseccionRectaCirculoMismo=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!puntoInterseccionRectaCirculo(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros,!0)&&(this.existe=TE_Existe,this.parametros[2]=1,this.copiaParametrosDirectos(),!0)},Punto.prototype.puntoInterseccionRectaCirculoOpuesto=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!puntoInterseccionRectaCirculo(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros,!1)&&(this.existe=TE_Existe,this.parametros[2]=1,this.copiaParametrosDirectos(),!0)},Punto.prototype.puntoInterseccionCirculosMismoLado=function(){this.existe=TE_NoExiste;for(var t=new Array,e=0;e<this.objRef.length;e++)if(this.objRef[e].existe==TE_NoExiste)return!1;return!!ejeRadical(t,this.objRef[0].parametros,this.objRef[1].parametros)&&(!!puntoInterseccionRectaCirculo(this.parametros,t,this.objRef[0].parametros,this.objRef[2].parametros,!0)&&(this.existe=TE_Existe,this.parametros[2]=1,this.copiaParametrosDirectos(),!0))},Punto.prototype.puntoInterseccionCirculosOtroLado=function(){this.existe=TE_NoExiste;for(var t=new Array,e=0;e<this.objRef.length;e++)if(null==this.objRef[e]||this.objRef[e].existe==TE_NoExiste)return!1;return!!ejeRadical(t,this.objRef[0].parametros,this.objRef[1].parametros)&&(!!puntoInterseccionRectaCirculo(this.parametros,t,this.objRef[0].parametros,this.objRef[2].parametros,!1)&&(this.existe=TE_Existe,this.parametros[2]=1,this.copiaParametrosDirectos(),!0))},Punto.prototype.puntoInterseccionRectaConicaMismo=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!puntoInterseccionRectaConica(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros,!0)&&(this.existe=TE_Existe,this.parametros[2]=1,this.copiaParametrosDirectos(),!0)},Punto.prototype.puntoInterseccionRectaConicaOtro=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!puntoInterseccionRectaConica(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros,!1)&&(this.existe=TE_Existe,this.parametros[2]=1,this.copiaParametrosDirectos(),!0)},Punto.prototype.puntoPoloCirculo=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!puntoPoloCirculo(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(0==this.parametros[2]?this.existe=TE_Proyectivo:this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Punto.prototype.puntoPoloConica=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!puntoPoloConica(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(0==this.parametros[2]?this.existe=TE_Proyectivo:this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Punto.prototype.puntoAfin=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;P=this.parametros;var e=new Array,a=new Array;return e=this.objRef[0].parametros,a=this.objRef[1].parametros,P[0]=a[0]*e[0]+a[1]*e[1]+a[2],P[1]=a[3]*e[0]+a[4]*e[1]+a[5],9==P.length&&(P[2]=a[6]*e[0]+a[7]*e[1]+a[8]),Math.abs(P[2])<epsilon&&(P[2]=0,this.existe=TE_Proyectivo),P[0]/=P[2],P[1]/=P[2],this.existe=TE_Existe,!0},Punto.prototype.puntoCentroConica=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!this.objRef[0].central&&(P=this.parametros,P[0]=this.objRef[0].CentroX,P[1]=this.objRef[0].CentroY,this.existe=TE_Existe,!0)},Punto.prototype.puntoEnRecta=function(){this.existe=TE_NoExiste;for(var t=new Array,e=0;e<this.objRef.length;e++)if(this.objRef[e].existe==TE_NoExiste)return!1;return!!rectaPerpendicular(t,this.objRef[0].parametros,this.parametros)&&(!!puntoInterseccionRectas(this.parametros,this.objRef[0].parametros,t)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),this.arrastrable=!0,!0))},Punto.prototype.verticePoligonoRegular=function(){this.existe=TE_NoExiste,P=this.parametros;var t=new Array,e=new Array;t=this.objRef[0].parametros,e=this.objRef[1].parametros;for(var a=0;a<this.objRef.length;a++)if(this.objRef[a].existe==TE_NoExiste)return!1;return P[0]=(e[0]-t[0])*P[3]-(e[1]-t[1])*P[4]+t[0],P[1]=(e[0]-t[0])*P[4]+(e[1]-t[1])*P[3]+t[1],this.existe=TE_Existe,this.copiaParametrosDirectos(),this.arrastrable=!1,!0}}function Recta(){this.parametros=new Array,this.color=new Array,this.ancho=new Array,this.objRef=new Array,this.referencias=new Array,this.visible=new Array,Recta.prototype.ponparametros=function(t,e,a){this.parametros[0]=t,this.parametros[1]=e,this.parametros[2]=a},Recta.prototype.ponConstantes=function(){this.tipo=TipoRecta,this.numComponentes=1,this.tDibujo=1,this.color[0]="#0000ff",this.ancho[0]=1,this.visible[0]=1,this.visible[1]=0,this.ponparametros(1,2,3)},this.ponConstantes(),Recta.prototype.RectaElena=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros,i=this.parametros;try{i[0]=a[0],i[1]=-1,l=hipotenusa(i[0],i[1]),i[0]/=l,i[1]/=l,i[2]=-i[0]*e[0]-i[1]*e[1]}catch(t){return!1}return this.existe=TE_Existe,this.tDibujo=1,!0},Recta.prototype.RectaDirecta=function(){arreglaRecta(this.parametros,this.parametros)&&(this.existe=TE_Existe)},Recta.prototype.rectaPorDosPuntos=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return rectaPorDosPuntos(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)?(this.existe=TE_Existe,this.tDibujo=1,!0):(respuesta="No existe la recta",!1)},Recta.prototype.segmentoPorDosPuntos=function(){this.rectaPorDosPuntos(),this.tDibujo=2},Recta.prototype.rectaParalela=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!paralela(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaPerpendicular=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!rectaPerpendicular(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaMediatriz=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros,i=this.parametros,o=new Array,r=new Array;return o[0]=(e[0]+a[0])/2,o[1]=(e[1]+a[1])/2,!!rectaPorDosPuntos(r,e,a)&&(!!rectaPerpendicular(i,r,o)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0))},Recta.prototype.rectaBisectrizInterior=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros;return!!bisectriz(this.parametros,e,a,!0)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaBisectrizExterior=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros;return!!bisectriz(this.parametros,e,a,!1)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaEjeRadical=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!ejeRadical(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaTangenteCirculoMismoLado=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!rectaTangenteCirculo(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros,!0)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaTangenteCirculoOtroLado=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!rectaTangenteCirculo(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros,!1)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaTangenteConicaMismoLado=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!rectaTangenteConica(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros,!0)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaTangenteConicaOtroLado=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!rectaTangenteConica(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros,!1)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaPolarCirculo=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!rectaPolarCirculo(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(0==this.parametros[0]&&0==this.parametros[1]?this.existe=TE_Proyectivo:this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaPolarConica=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!rectaPolarConica(this.parametros,this.objRef[0].parametros,this.objRef[1].parametros)&&(this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Recta.prototype.rectaEjeFocalConica=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;for(t=0;t<3;t++)this.parametros[t]=this.objRef[0].EjeMax[t];return this.existe=TE_Existe,!0},Recta.prototype.rectaEjeConjugadoConica=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;for(t=0;t<3;t++)this.parametros[t]=this.objRef[0].EjeMin[t];return this.existe=TE_Existe,!0},Recta.prototype.rectaDirectrizConica=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;if(con=this.objRef[0],con.tipoConica==con.Parabola)for(t=0;t<3;t++)this.parametros[t]=con.Dir1[t];return this.existe=TE_Existe,!0},Recta.prototype.dibujaSegmentoExterior=function(){var t=this.parametros[0],e=this.parametros[1],a=this.parametros[2],i=this.objRef[0].parametros,o=this.objRef[1].parametros,r=new Array,s=new Array;Math.abs(e)<epsilon?(i[1]<o[1]?(r[0]=i[0],r[1]=i[1],s[0]=o[0],s[1]=o[1]):(r[0]=o[0],r[1]=o[1],s[0]=i[0],s[1]=i[1]),0!=t&&(segmento(this.color[1],this.ancho[1],cambiaX(-a/t),cambiaY(yMinimo),cambiaX(r[0]),cambiaY(r[1])),segmento(this.color[1],this.ancho[1],cambiaX(s[0]),cambiaY(s[1]),cambiaX(-a/t),cambiaY(yMaximo)))):(i[0]<o[0]?(r[0]=i[0],r[1]=i[1],s[0]=o[0],s[1]=o[1]):(r[0]=o[0],r[1]=o[1],s[0]=i[0],s[1]=i[1]),segmento(this.color[1],this.ancho[1],cambiaX(xMinimo),cambiaY((-t*xMinimo-a)/e),cambiaX(r[0]),cambiaY(r[1])),segmento(this.color[1],this.ancho[1],cambiaX(s[0]),cambiaY(s[1]),cambiaX(xMaximo),cambiaY((-t*xMaximo-a)/e)))},Recta.prototype.dibuja=function(){if(this.existe==TE_Existe){if(1==this.visible[0]){switch(this.tDibujo){case 1:dibujaRectaGeneral(this.color[0],this.ancho[0],this.parametros,this.ancho[0]);break;case 2:segmento(this.color[0],this.ancho[0],cambiaX(this.objRef[0].parametros[0]),cambiaY(this.objRef[0].parametros[1]),cambiaX(this.objRef[1].parametros[0]),cambiaY(this.objRef[1].parametros[1]))}if(null!=this.miEtiqueta)switch(this.miEtiqueta.visible){case 0:break;case 2:this.mandaEtiqueta(this.nombre);break;case 1:this.mandaEtiqueta(escribePolinomio(this.parametros,["x","y",""])+"=0")}}2==this.tDibujo&&1==this.visible[1]&&this.dibujaSegmentoExterior()}},Recta.prototype.rellena=function(){},Recta.prototype.mandaEtiqueta=function(t){if(this.miEtiqueta.ancla>-1&&listaObjetos[this.miEtiqueta.ancla].visible[0]>0)switch(this.tDibujo){case 1:if(Math.abs(this.parametros[1])>epsilon)var e=0,a=Math.max(-this.parametros[2]/this.parametros[1],yMinimo+1);break;case 2:e=(this.objRef[1].parametros[0]+this.objRef[0].parametros[0])/2,a=(this.objRef[1].parametros[1]+this.objRef[0].parametros[1])/2}this.ponEtiqueta(t,cambiaX(e)+10,cambiaY(a)+10)}}function Angulo(){this.parametros=new Array,this.paramDir=new Array,this.objRef=new Array,this.referencias=new Array,this.nivel=new Array,this.color=new Array,this.ancho=new Array,this.tipoLinea=new Array,this.visible=new Array,Angulo.prototype.ponConstantes=function(){this.tipo=TipoMedidaAngulo,this.numParam=7,this.numParamDir=2,this.numComponentes=2,this.visible[0]=0,this.traza=!1,this.tDibujo=DibujoArco,this.color[0]="#ff0000",this.ancho[0]=1},this.ponConstantes(),Angulo.prototype.arcoEnCirculo=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros,i=this.objRef[2].parametros;return this.parametros[0]=e[0],this.parametros[1]=e[1],this.parametros[2]=e[2],this.parametros[3]=argumento(e,a),this.parametros[4]=argumento(e,i),this.parametros[5]=1,this.parametros[6]=a[0],this.parametros[7]=a[1],this.parametros[8]=i[0],this.parametros[9]=i[1],this.existe=TE_Existe,this.tDibujo=1,!0},Angulo.prototype.anguloDirecto=function(){return this.parametros[2]=1,this.existe=TE_Existe,!0},Angulo.prototype.anguloAOB=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros,i=this.objRef[2].parametros,o=i[0]-a[0],r=i[1]-a[1],s=e[1]-a[1],n=e[0]-a[0];return this.parametros[0]=Math.atan2(n*r-o*s,o*n+r*s),this.parametros[2]=1,this.existe=TE_Existe,!0},Angulo.prototype.anguloConica=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return this.parametros[0]=this.objRef[0].teta,this.parametros[0]<-Math.PI/2&&(this.parametros[0]+=Math.PI),this.parametros[0]>Math.PI/2&&(this.parametros[0]-=Math.PI),this.parametros[2]=1,this.existe=TE_Existe,!0},Angulo.prototype.arcoAOB=function(){var t=new Array,e=new Array,a=new Array,i=this.objRef[0].parametros,o=this.objRef[1].parametros,r=this.objRef[2].parametros;return this.parametros[1]=o[0],this.parametros[2]=o[1],this.parametros[3]=i[0],this.parametros[4]=i[1],this.parametros[5]=r[0],this.parametros[6]=r[1],t[0]=this.parametros[3]-this.parametros[1],t[1]=this.parametros[4]-this.parametros[2],e[0]=this.parametros[5]-this.parametros[1],e[1]=this.parametros[6]-this.parametros[2],a[0]=e[0]*t[0]+e[1]*t[1],a[1]=e[1]*t[0]-e[0]*t[1],this.parametros[0]=Math.atan2(a[1],a[0]),this.parametros[0]<0&&(this.parametros[0]+=2*Math.PI),this.existe=TE_Existe,!0},Angulo.prototype.arcoAOB_o=function(){this.arcoAOB();var t=new Array;return this.objRef[3].esVerdadero>0||(t[0]=this.parametros[3],t[1]=this.parametros[4],this.parametros[3]=this.parametros[5],this.parametros[4]=this.parametros[6],this.parametros[5]=t[0],this.parametros[6]=t[1],this.parametros[0]=2*Math.PI-this.parametros[0]),this.existe=TE_Existe,!0},Angulo.prototype.dibuja=function(){if(this.existe==TE_Existe){if(5==this.tDibujo){var t=Math.atan2(this.parametros[4]-this.parametros[2],this.parametros[3]-this.parametros[1]),e=this.parametros[0];this.visible[0]&&pintaArco(this.color[0],1,cambiaX(this.parametros[1]),cambiaY(this.parametros[2]),5*this.ancho[0],t,t+e,!0),this.visible[1]&&llenaArco(this.color[1],1,cambiaX(this.parametros[1]),cambiaY(this.parametros[2]),5*this.ancho[0],t,t+e,!0)}else pintaArco(this.color[0],this.ancho[0],cambiaX(this.parametros[0]),cambiaY(this.parametros[1]),cambiaEsc(this.parametros[2]),this.parametros[3],this.parametros[4],!0);if(null!=this.miEtiqueta)switch(this.miEtiqueta.visible){case 0:break;case 2:this.mandaEtiqueta(this.nombre);break;case 1:var a;null!=this.miEtiqueta&&null!=this.miEtiqueta.ancla&&(a=enGrados?180*this.parametros[0]/Math.PI:this.parametros[0],-1==this.miEtiqueta.ancla?this.mandaEtiqueta(a.toFixed(ambiente.decimales)):listaObjetos[this.miEtiqueta.ancla].mandaEtiqueta(a.toFixed(ambiente.decimales)))}}},Angulo.prototype.rellena=function(){},Angulo.prototype.mandaEtiqueta=function(t){this.ponEtiqueta(t,cambiaX(this.parametros[1])+20,cambiaY(this.parametros[2])+20)}}function Poligono(){this.parametros=new Array,this.paramDir=new Array,this.objRef=new Array,this.referencias=new Array,this.nivel=new Array,this.color=new Array,this.ancho=new Array,this.tipoLinea=new Array,this.visible=new Array,Poligono.prototype.ponConstantes=function(){this.tDibujo=DibujoPoligono,this.tipo=TipoPoligono,this.numComponentes=2,this.numParam=0,this.numParamDir=0,this.traza=!1,this.visible[0]=1,this.color[0]="#00ff00",this.visible[1]=0,this.color[1]="#aaffaa",this.ancho[0]=1},this.ponConstantes(),Poligono.prototype.creaPoligono=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;this.existe=TE_Existe},Poligono.prototype.dibuja=function(){var t=new Array,e=new Array;if(this.existe==TE_Existe&&(this.visible[0]=1)){for(var a=0;a<this.objRef.length;a++)t[a]=cambiaX(this.objRef[a].parametros[0]),e[a]=cambiaY(this.objRef[a].parametros[1]);(this.visible[1]=1)&&rellenaPoligono(this.color[1],t,e),dibujaPoligono(this.color[0],this.ancho[0],t,e)}},Poligono.prototype.rellena=function(){},Poligono.prototype.perimetroPoligono=function(){for(var t=0,e=new Array,a=this.objRef[0].parametros,i=1;i<this.objRef.length;i++){var o=new Array,r=this.objRef[i].parametros;o[0]=r[0]-a[0],o[1]=r[1]-a[1],e[i]=o}for(i=1;i<this.objRef.length-1;i++)t+=distancia(e[i],e[i+1]);return t},Poligono.prototype.areaPoligono=function(){for(var t=0,e=new Array,a=this.objRef[0].parametros,i=1;i<this.objRef.length;i++){var o=new Array,r=this.objRef[i].parametros;o[0]=r[0]-a[0],o[1]=r[1]-a[1],e[i]=o}for(i=1;i<this.objRef.length-1;i++)t+=e[i][0]*e[i+1][1]-e[i][1]*e[i+1][0];return t/=2}}function Grafica(){this.parametros=new Array,this.paramDir=new Array,this.objRef=new Array,this.referencias=new Array,this.nivel=new Array,this.color=new Array,this.ancho=new Array,this.tipoLinea=new Array,this.visible=new Array,Grafica.prototype.ponConstantes=function(){this.tDibujo=DibujoPoligono,this.tipo=TipoFuncionGeneral,this.numComponentes=2,this.numParam=0,this.numParamDir=0,this.traza=!1,this.visible[0]=1,this.color[0]="#00ff00",this.visible[1]=0,this.color[1]="#aaffaa",this.ancho[0]=1,this.existe=TE_Existe},this.ponConstantes(),Grafica.prototype.dibuja=function(){var t,e=new Array,a=new Array,i=0,o=0,r=0,s=this.parametros[3]<10?10:this.parametros[3]>2e3?1999:this.parametros[3],n=(this.parametros[1]-this.parametros[0])/s;this.parametros[4]=this.parametros[0];for(var h=0,c=0;c<=s;c++){if(t=this.datoFormula.arrPolacas[2].Evalua(),o=cambiaX(this.parametros[4]),i=cambiaY(t),h>0?(dx=o-e[h-1],dy=i-a[h-1],ang=180*Math.atan(dy/dx)/Math.PI):(pendiente=0,ang=0,paso=0),isNaN(t)?r+=2:t>limiteMaximo?t=limiteMaximo:t<-limiteMaximo&&(t=-limiteMaximo),(i=cambiaY(t))>yArriba&i<yAbajo&&(r=0),h>0&&Math.abs(a[h-1]-i)>limiteMaximo&&(r+=1),h>1&&Math.abs(dy)>5*dx&&(r+=2),e[h]=o,a[h]=i,r>1){dibujaPoligonoAbierto(this.color[0],this.ancho[0],e,a);e=new Array,a=new Array;e[0]=o,a[0]=i,h=0,r=0}h++,this.parametros[4]+=n,angant=ang}dibujaPoligonoAbierto(this.color[0],this.ancho[0],e,a)}}function Circulo(){this.parametros=new Array,this.paramDir=new Array,this.objRef=new Array,this.referencias=new Array,this.nivel=new Array,this.color=new Array,this.ancho=new Array,this.tipoLinea=new Array,this.visible=new Array,Circulo.prototype.ponparametros=function(t,e,a){this.parametros[0]=t,this.parametros[1]=e,this.parametros[2]=a},Circulo.prototype.ponConstantes=function(){this.tipo=TipoCirculo,this.numParam=4,this.numParamDir=3,this.numComponentes=2,this.visible[0]=1,this.traza=!1,this.tDibujo="63",this.color[0]="#ff0000",this.ancho[0]=1,this.ponparametros(0,0,5)},this.ponConstantes(),Circulo.prototype.ponparametros=function(t,e,a){this.parametros[0]=t,this.parametros[1]=e,this.parametros[2]=a},Circulo.prototype.circuloDirecto=function(){return this.existe=TE_Existe,!0},Circulo.prototype.circuloCentroRadio=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!(this.objRef[1].parametros[0]<0)&&(this.parametros[0]=this.objRef[0].parametros[0],this.parametros[1]=this.objRef[0].parametros[1],this.parametros[2]=this.objRef[1].parametros[0],this.existe=TE_Existe,!0)},Circulo.prototype.circuloCentroPunto=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros,i=hipotenusa(e[0]-a[0],e[1]-a[1]);return this.parametros[0]=e[0],this.parametros[1]=e[1],this.parametros[2]=i,this.existe=TE_Existe,this.copiaParametrosDirectos(),!0},Circulo.prototype.circuloCircuncirculo=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros,i=this.objRef[2].parametros,o=new Array,r=new Array,s=new Array;if(!mediatriz(o,e,a))return!1;if(!mediatriz(r,e,i))return!1;if(!puntoInterseccionRectas(s,o,r))return!1;var n=hipotenusa(e[0]-s[0],e[1]-s[1]);return this.parametros[0]=s[0],this.parametros[1]=s[1],this.parametros[2]=n,this.existe=TE_Existe,this.copiaParametrosDirectos(),!0},Circulo.prototype.circuloIncirculo=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e,a=new Array,i=new Array,o=new Array,r=this.objRef[0].parametros,s=this.objRef[1].parametros,n=this.objRef[2].parametros;return a[0]=r[0]-s[0],a[1]=r[1]-s[1],a[2]=r[2]-s[2],i[0]=s[0]-n[0],i[1]=s[1]-n[1],i[2]=s[2]-n[2],!!puntoInterseccionRectas(o,a,i)&&(e=Math.abs(r[0]*o[0]+r[1]*o[1]+r[2]),this.parametros[0]=o[0],this.parametros[1]=o[1],this.parametros[2]=e,this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Circulo.prototype.circuloExcirculo=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e,a=new Array,i=new Array,o=new Array,r=this.objRef[0].parametros,s=this.objRef[1].parametros,n=this.objRef[2].parametros;return a[0]=r[0]+s[0],a[1]=r[1]+s[1],a[2]=r[2]+s[2],i[0]=-s[0]-n[0],i[1]=-s[1]-n[1],i[2]=-s[2]-n[2],!!puntoInterseccionRectas(o,a,i)&&(e=Math.abs(r[0]*o[0]+r[1]*o[1]+r[2]),this.parametros[0]=o[0],this.parametros[1]=o[1],this.parametros[2]=e,this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Circulo.prototype.circuloTransformado=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.parametros,a=this.objRef[0].parametros,i=this.objRef[1].parametros;return this.objRef[1].TipoTransf>TT_Semejanza?TE_NoExiste:(e[0]=i[0]*a[0]+i[1]*a[1]+i[2],e[1]=i[3]*a[0]+i[4]*a[1]+i[5],this.objRef[1].TipoTransf==TT_Rigida?e[2]=a[2]:e[2]=hipotenusa(i[0],i[1])*a[2],this.existe=TE_Existe,this.copiaParametrosDirectos(),!0)},Circulo.prototype.dibuja=function(){this.existe==TE_Existe&&1==this.visible[0]&&pintaCirculo(this.color[0],this.ancho[0],cambiaX(this.parametros[0]),cambiaY(this.parametros[1]),cambiaEsc(this.parametros[2]))},Circulo.prototype.rellena=function(){}}function FuncionRigida(){this.parametros=new Array,this.paramDir=new Array,this.objRef=new Array,this.referencias=new Array,this.nivel=new Array,this.color=new Array,this.ancho=new Array,this.tipoLinea=new Array,this.visible=new Array,FuncionRigida.prototype.ponConstantes=function(){this.tipo=TipoFuncionRigida,this.existe=TE_Existe},this.ponConstantes(),FuncionRigida.prototype.transfTranslacion=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.parametros,a=this.objRef[0].parametros,i=this.objRef[1].parametros;return e[0]=e[4]=e[8]=e[9]=e[13]=e[17]=1,e[1]=e[3]=e[6]=e[7]=e[10]=e[12]=e[15]=e[16]=0,e[2]=i[0]-a[0],e[5]=i[1]-a[1],e[11]=-e[2],e[14]=-e[5],TipoTransf=TT_Rigida,this.existe=TE_Existe,!0},FuncionRigida.prototype.transfRotacion=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.parametros,a=this.objRef[0].parametros,i=this.objRef[1].parametros;return s=Math.sin(i[0]),c=Math.cos(i[0]),e[0]=e[9]=c,e[4]=e[13]=c,e[1]=e[12]=-s,e[3]=e[10]=s,e[2]=(1-c)*a[0]+s*a[1],e[5]=-s*a[0]+(1-c)*a[1],e[11]=(1-c)*a[0]-s*a[1],e[14]=s*a[0]+(1-c)*a[1],e[15]=e[6]=0,e[16]=e[7]=0,e[17]=e[8]=1,this.existe=TE_Existe,TipoTransf=TT_Rigida,!0},FuncionRigida.prototype.transfReflexion=function(){TipoTransf=TT_Rigida,this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.parametros,a=this.objRef[0].parametros;return e[9]=e[0]=1-2*a[0]*a[0],e[10]=e[1]=-2*a[0]*a[1],e[11]=e[2]=-2*a[0]*a[2],e[12]=e[3]=-2*a[0]*a[1],e[13]=e[4]=1-2*a[1]*a[1],e[14]=e[5]=-2*a[1]*a[2],e[15]=e[6]=0,e[16]=e[7]=0,e[17]=e[8]=1,this.existe=TE_Existe,!0}}function FuncionSemejanza(){this.parametros=new Array,this.paramDir=new Array,this.objRef=new Array,this.referencias=new Array,this.nivel=new Array,this.color=new Array,this.ancho=new Array,this.tipoLinea=new Array,this.visible=new Array,FuncionSemejanza.prototype.ponConstantes=function(){this.tipo=TipoFuncionRigida,this.existe=TE_Existe},this.ponConstantes(),FuncionSemejanza.prototype.transfHomotecia=function(){TipoTransf=TT_Rigida,this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.parametros,a=this.objRef[0].parametros,i=this.objRef[1].parametros;return!(Math.abs(i)<epsilon)&&(e[4]=e[0]=i,e[9]=e[13]=1/i,e[3]=e[1]=e[10]=e[12]=0,e[2]=(1-i)*a[0],e[5]=(1-i)*a[1],e[11]=(1-1/i)*a[0],e[14]=(1-1/i)*a[1],e[15]=e[6]=0,e[16]=e[7]=0,e[17]=e[8]=1,TipoTransf=Math.abs(Math.abs(i)-1)>epsilon?TT_Semejanza:TT_Rigida,this.existe=TE_Existe,!0)},FuncionSemejanza.prototype.transfComposicion=function(){var t=this.parametros,e=this.objRef[0].parametros,a=this.objRef[1].parametros;return t[0]=a[0]*e[0]+a[1]*e[3]+a[2]*e[6],t[1]=a[0]*e[1]+a[1]*e[4]+a[2]*e[7],t[2]=a[0]*e[2]+a[1]*e[5]+a[2]*e[8],t[3]=a[3]*e[0]+a[4]*e[3]+a[5]*e[6],t[4]=a[3]*e[1]+a[4]*e[4]+a[5]*e[7],t[5]=a[3]*e[2]+a[4]*e[5]+a[5]*e[8],t[6]=a[6]*e[0]+a[7]*e[3]+a[8]*e[6],t[7]=a[6]*e[1]+a[7]*e[4]+a[8]*e[7],t[8]=a[6]*e[2]+a[7]*e[5]+a[8]*e[8],t[9]=e[9]*a[9]+e[10]*a[12]+e[11]*a[15],t[10]=e[9]*a[10]+e[10]*a[13]+e[11]*a[16],t[11]=e[9]*a[11]+e[10]*a[14]+e[11]*a[17],t[12]=e[12]*a[9]+e[13]*a[12]+e[14]*a[15],t[13]=e[12]*a[10]+e[13]*a[13]+e[14]*a[16],t[14]=e[12]*a[11]+e[13]*a[14]+e[14]*a[17],t[15]=e[15]*a[9]+e[16]*a[12]+e[17]*a[15],t[16]=e[15]*a[10]+e[16]*a[13]+e[17]*a[16],t[17]=e[15]*a[11]+e[16]*a[14]+e[17]*a[17],this.checaProyectiva()},FuncionSemejanza.prototype.checaProyectiva=function(){var t=this.parametros;if(Math.abs(t[6])<epsilon&&Math.abs(t[6])<epsilon){for(var e=0;e<6;e++)t[e]/=t[8];return this.ChecaAfin()}return TipoTransf=TT_Proyectiva,t[9]=t[4]*t[8]-t[5]*t[7],t[10]=t[2]*t[7]-t[1]*t[8],t[11]=t[1]*t[5]-t[2]*t[4],t[12]=t[5]*t[6]-t[3]*t[8],t[13]=t[0]*t[8]-t[2]*t[6],t[14]=t[2]*t[3]-t[0]*t[5],t[15]=t[3]*t[7]-t[4]*t[6],t[16]=t[1]*t[6]-t[0]*t[7],t[17]=t[0]*t[4]-t[1]*t[3],det=t[0]*t[9]+t[1]*t[12]+t[2]*t[15],Math.abs(det)<epsilon?(this.existe=TE_NoExiste,!1):(this.existe=TE_Existe,!0)},FuncionSemejanza.prototype.checaProyectiva=function(){var t=this.parametros,e=t[0]*t[4]-t[1]*t[3];return Math.abs(e)<epsilon?(this.existe=TE_NoExiste,!1):(Math.abs(Math.abs(t[0])-Math.abs(t[4]))<epsilon&&Math.abs(Math.abs(t[1])-Math.abs(t[3]))<epsilon?Math.abs(Math.abs(e)-t[8]*t[8])<epsilon?this.TipoTransf=TT_Rigida:this.TipoTransf=TT_Semejanza:TipoTransf=TT_Afin,t[9]=t[4]/e,t[10]=-t[1]/e,t[12]=-t[3]/e,t[13]=t[0]/e,t[11]=-t[9]*t[2]-t[10]*t[5],t[14]=-t[12]*t[2]-t[13]*t[5],t[6]=t[7]=t[15]=t[16]=0,t[8]=t[17]=1,this.existe=TE_Existe,!0)}}function Conica(){new Array,new Array;this.parametros=new Array,this.paramDir=new Array,this.objRef=new Array,this.referencias=new Array,this.nivel=new Array,this.color=new Array,this.visible=new Array,this.ancho=new Array,this.tipoLinea=new Array,this.Paramx=new Array,this.Paramy=new Array,this.EjeMax=new Array,this.EjeMin=new Array,this.Asin1=new Array,this.Asin2=new Array,this.Foco1=new Array,this.Foco2=new Array,this.Dir1=new Array,this.Dir2=new Array,this.V1=new Array,Conica.prototype.ponConstantes=function(){this.tipo=TipoConica,this.numComponentes=6,this.numParam=13,this.numParamDir=6,this.traza=!1;this.visible[0]=1,this.color[0]="#ff0000",this.ancho[0]=2},this.ponConstantes(),Conica.prototype.conicaDirecta=function(){return this.copiaParametrosDirectos(),completaConica(this.parametros),analizaConica(this,this.parametros),this.existe=TE_Existe,this.describeConica(this.parametros),!0},Conica.prototype.parabolaFocoDirectriz=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.parametros,a=this.objRef[0].parametros,i=this.objRef[1].parametros;return e[0]=i[0]*i[0]-1,e[1]=i[0]*i[1],e[2]=i[1]*i[1]-1,e[3]=i[0]*i[2]+a[0],e[4]=i[1]*i[2]+a[1],e[5]=i[2]*i[2]-a[0]*a[0]-a[1]*a[1],completaConica(e),analizaConica(this,this.parametros),this.existe=TE_Existe,this.copiaParametrosDirectos(),this.describeConica(e),!0},Conica.prototype.parabola4Tangentes=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!parabola4Tangentes(this,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros,this.objRef[3].parametros)&&(this.existe=TE_Existe,!0)},Conica.prototype.ElipseFocosPunto=function(){try{this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros,i=this.objRef[2].parametros;return!!conicaFocos(this,e,a,(hipotenusa(e[0]-i[0],e[1]-i[1])+hipotenusa(a[0]-i[0],a[1]-i[1]))/2)&&(this.existe=TE_Existe,!0)}catch(e){return this.existe=TE_NoExiste,respuesta=(respuesta="Error en elipse "+this.nombre+" i="+t+" "+e.toString()+"<br>")+this.objRef[0].nombre+" "+this.objRef[1].nombre+"<br>",!1}},Conica.prototype.hiperbolaFocosPunto=function(){try{this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros,i=this.objRef[2].parametros;return!!conicaFocos(this,e,a,(hipotenusa(e[0]-i[0],e[1]-i[1])-hipotenusa(a[0]-i[0],a[1]-i[1]))/2)&&(this.existe=TE_Existe,!0)}catch(e){return this.existe=TE_NoExiste,respuesta=(respuesta="Error en hiperbola "+this.nombre+" i="+t+" "+e.toString()+"<br>")+this.objRef[0].nombre+" "+this.objRef[1].nombre+"<br>",!1}},Conica.prototype.conicaFocosA=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!conicaFocos(this,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros[0])&&(this.existe=TE_Existe,this.describeConica(this.parametros),analizaConica(this,this.parametros),!0)},Conica.prototype.conicaFocosDirectrizPunto=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=this.objRef[0].parametros,a=this.objRef[1].parametros,i=this.objRef[2].parametros,o=a[0]*i[0]+a[1]*i[1]+a[2];return!(Math.abs(o)<epsilon)&&(!!ConicaFocoDirectriz(this,e,a,hipotenusa(e[0]-i[0],e[1]-i[1])/o)&&(this.existe=TE_Existe,!0))},Conica.prototype.conicaFocoDirectrizExcentricidad=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;return!!ConicaFocoDirectriz(this,this.objRef[0].parametros,this.objRef[1].parametros,this.objRef[2].parametros[0])&&(this.existe=TE_Existe,!0)},Conica.prototype.conica5Puntos=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e,a,i,o=new Array,r=new Array,s=new Array,n=new Array,h=new Array,c=new Array,p=this.objRef[0].parametros,u=this.objRef[1].parametros,l=this.objRef[2].parametros,m=this.objRef[3].parametros,b=this.objRef[4].parametros,f=this.parametros;if(rectaDosPuntosSinNormalizar(o,p,u),rectaDosPuntosSinNormalizar(r,l,m),rectaDosPuntosSinNormalizar(s,p,l),rectaDosPuntosSinNormalizar(n,m,u),conicaDegenerada(h,o,r),conicaDegenerada(c,s,n),e=evaluaConica(h,b),a=evaluaConica(c,b),(i=Math.abs(e)+Math.abs(a))<epsilon)return!1;e/=i,a/=i;for(t=0;t<6;t++)f[t]=e*c[t]-a*h[t];return completaConica(f),this.existe=TE_Existe,Math.abs(this.parametros[12])<epsilon&&(this.parametros[12]=0),this.copiaParametrosDirectos(),this.describeConica(f),analizaConica(this,this.parametros),!0},Conica.prototype.conica5Rectas=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e,a,i=new Array,o=new Array,r=new Array,s=new Array,n=new Array,h=new Array,c=this.parametros,p=this.objRef[0].parametros,u=this.objRef[1].parametros,l=this.objRef[2].parametros,m=this.objRef[3].parametros,b=this.objRef[4].parametros;puntoInterseccionRectas(i,p,u),puntoInterseccionRectas(o,l,m),puntoInterseccionRectas(r,p,l),puntoInterseccionRectas(s,m,u),conicaDegenerada(n,i,o),conicaDegenerada(h,r,s),e=formaPolarizada(n,b,b),a=formaPolarizada(h,b,b);for(t=0;t<6;t++)c[t+6]=e*h[t]-a*n[t];return completaConicaDual(c),analizaConica(this,c),this.existe=TE_Existe,c[12]=c[0]*c[6]+c[1]*c[7]+c[3]*c[9],Math.abs(this.parametros[12])<epsilon&&(this.parametros[12]=0),!0},Conica.prototype.conicaTransformada=function(){this.existe=TE_NoExiste;for(var t=0;t<this.objRef.length;t++)if(this.objRef[t].existe==TE_NoExiste)return!1;var e=new Array,a=this.parametros,i=this.objRef[0].parametros,o=this.objRef[1].parametros,r=new Array;if(this.objRef[0].Tipo==TipoCirculo){e[0]=e[2]=1,e[1]=0,e[3]=-i[0],e[4]=-i[1],e[5]=i[0]*i[0]+i[1]*i[1]-i[2]*i[2];for(t=0;t<6;t++)i[t]=e[t]}for(t=0;t<9;t++)r[t]=o[t+9];return a[0]=r[0]*(i[0]*r[0]+i[1]*r[3]+i[3]*r[6])+r[3]*(i[1]*r[0]+i[2]*r[3]+i[4]*r[6])+r[6]*(i[3]*r[0]+i[4]*r[3]+i[5]*r[6]),a[1]=r[0]*(i[0]*r[1]+i[1]*r[4]+i[3]*r[7])+r[3]*(i[1]*r[1]+i[2]*r[4]+i[4]*r[7])+r[6]*(i[3]*r[1]+i[4]*r[4]+i[5]*r[7]),a[2]=r[1]*(i[0]*r[1]+i[1]*r[4]+i[3]*r[7])+r[4]*(i[1]*r[1]+i[2]*r[4]+i[4]*r[7])+r[7]*(i[3]*r[1]+i[4]*r[4]+i[5]*r[7]),a[3]=r[0]*(i[0]*r[2]+i[1]*r[5]+i[3]*r[8])+r[3]*(i[1]*r[2]+i[2]*r[5]+i[4]*r[8])+r[6]*(i[3]*r[2]+i[4]*r[5]+i[5]*r[8]),a[4]=r[1]*(i[0]*r[2]+i[1]*r[5]+i[3]*r[8])+r[4]*(i[1]*r[2]+i[2]*r[5]+i[4]*r[8])+r[7]*(i[3]*r[2]+i[4]*r[5]+i[5]*r[8]),a[5]=r[2]*(i[0]*r[2]+i[1]*r[5]+i[3]*r[8])+r[5]*(i[1]*r[2]+i[2]*r[5]+i[4]*r[8])+r[8]*(i[3]*r[2]+i[4]*r[5]+i[5]*r[8]),completaConica(a),analizaConica(this,a),this.existe=TE_Existe,this.copiaParametrosDirectos(),this.describeConica(a),!0},Conica.prototype.describeConica=function(t){var e=t[0]*t[2]-t[1]*t[1],a=t[0]+t[2];return this.central=!1,Math.abs(t[12])>epsilon?e>epsilon?t[12]*a>0?this.tipoConica=0:(this.tipoConica=7,this.central=!0):e<-epsilon?(this.tipoConica=8,this.central=!0):this.tipoConica=9:this.tipoConica=10,this.tipoConica},Conica.prototype.datosConicaCentralGeneral=function(t){var e,a,i,o,r,s,n;if(e=Math.sqrt(4*t[1]*t[1]+(t[2]-t[0])*(t[2]-t[0])),this.ejeX=(t[0]+t[2]-e)/2,this.ejeY=this.ejeX+e,a=-this.ejeX*this.ejeY/t[12],this.ejeX*=a,this.ejeY*=a,this.ejeX=signo(this.ejeX)/Math.sqrt(Math.abs(this.ejeX)),this.ejeY=signo(this.ejeY)/Math.sqrt(Math.abs(this.ejeY)),this.ejeX<this.ejeY||this.ejeX<0){var h=this.ejeX;this.ejeX=this.ejeY,this.ejeY=h}this.CentroX=t[9]/t[11],this.CentroY=t[10]/t[11],8==this.tipoConica&&(this.Asin1[0]=t[0],this.Asin1[1]=t[1]-Math.sqrt(t[1]*t[1]-t[0]*t[2]),this.Asin1[2]=-this.Asin1[0]*this.CentroX-this.Asin1[1]*this.CentroY,this.Asin2[0]=t[0],this.Asin2[1]=-this.Asin1[1]+2*t[1],this.Asin2[2]=-this.Asin2[0]*this.CentroX-this.Asin2[1]*this.CentroY),this.EjeMax[0]=2*t[1],this.EjeMax[1]=t[2]-t[0]-Math.sqrt(4*t[1]*t[1]+(t[0]-t[2])*(t[0]-t[2])),this.EjeMax[2]=-this.EjeMax[0]*this.CentroX-this.EjeMax[1]*this.CentroY,this.EjeMin[0]=this.EjeMax[0],this.EjeMin[1]=-this.EjeMax[1]+2*(t[2]-t[0]),this.EjeMin[2]=-this.EjeMin[0]*this.CentroX-this.EjeMin[1]*this.CentroY,(i=-this.EjeMax[0]/this.EjeMax[1])*(o=t[1]*t[12])<0&&(i=-1/i),s=i*(r=Math.sqrt(o/i)),r/=t[11],s/=t[11],n=t[12]>0?e:-e,this.a=(t[0]+t[2]+n)/2,this.b=this.a-n,a=-this.a*this.b/t[12],this.a*=a,this.b*=a,this.a=1/Math.sqrt(Math.abs(this.a)),this.b=1/Math.sqrt(Math.abs(this.b)),8==this.tipoConica?this.c=Math.sqrt(this.a*this.a+this.b*this.b):this.c=Math.sqrt(this.a*this.a-this.b*this.b),Math.abs(this.a)>epsilon&&(this.e=this.c/this.a),this.Foco1[0]=this.CentroX+r,this.Foco1[1]=this.CentroY+s,this.Foco2[0]=this.CentroX-r,this.Foco2[1]=this.CentroY-s,this.Dir1[0]=t[0]*this.Foco1[0]+t[1]*this.Foco1[1]+t[3],this.Dir1[1]=t[1]*this.Foco1[0]+t[2]*this.Foco1[1]+t[4],this.Dir1[2]=t[3]*this.Foco1[0]+t[4]*this.Foco1[1]+t[5],this.Dir2[0]=t[0]*this.Foco2[0]+t[1]*this.Foco2[1]+t[3],this.Dir2[1]=t[1]*this.Foco2[0]+t[2]*this.Foco2[1]+t[4],this.Dir2[2]=t[3]*this.Foco2[0]+t[4]*this.Foco2[1]+t[5],this.teta=Math.atan2(this.Foco1[1]-this.Foco2[1],this.Foco1[0]-this.Foco2[0])},Conica.prototype.datosConicaCentral=function(t){var e,a,i,o=-t[0]*t[2]/t[12];this.ejeX=t[0]*o,this.ejeY=t[2]*o,this.ejeX=signo(this.ejeX)/Math.sqrt(Math.abs(this.ejeX)),this.ejeY=signo(this.ejeY)/Math.sqrt(Math.abs(this.ejeY)),this.CentroX=t[9]/t[11],this.CentroY=t[10]/t[11],8==this.tipoConica?(this.Asin1[0]=this.ejeY,this.Asin1[1]=this.ejeX,this.Asin1[2]=-this.Asin1[0]*this.CentroX-this.Asin1[1]*this.CentroY,this.Asin2[0]=-this.ejeY,this.Asin2[1]=this.ejeX,this.Asin2[2]=-this.Asin2[0]*this.CentroX-this.Asin2[1]*this.CentroY,e=Math.sqrt(this.ejeX*this.ejeX+this.ejeY*this.ejeY),a=0,i=this.ejeX>0):(e=Math.sqrt(Math.abs(this.ejeX*this.ejeX-this.ejeY*this.ejeY)),a=0,i=this.ejeX>this.ejeY),i?(this.Foco1[0]=this.CentroX+e,this.Foco1[1]=this.CentroY+a,this.Foco2[0]=this.CentroX-e,this.Foco2[1]=this.CentroY-a,this.EjeMax[0]=0,this.EjeMax[1]=1,this.EjeMax[2]=-this.CentroY,this.EjeMin[0]=1,this.EjeMin[1]=0,this.EjeMin[2]=-this.CentroX,this.teta=0):(this.Foco1[0]=this.CentroX+a,this.Foco1[1]=this.CentroY+e,this.Foco2[0]=this.CentroX-a,this.Foco2[1]=this.CentroY-e,this.EjeMin[0]=0,this.EjeMin[1]=1,this.EjeMin[2]=-this.CentroY,this.EjeMax[0]=1,this.EjeMax[1]=0,this.EjeMax[2]=-this.CentroX,this.teta=Math.PI/2,temp=this.ejeX,this.ejeX=this.ejeY,this.ejeY=temp),this.a=Math.abs(this.ejeX),this.b=Math.abs(this.ejeY),this.c=e,this.e=this.c/this.a,this.Dir1[0]=t[0]*this.Foco1[0]+t[1]*this.Foco1[1]+t[3],this.Dir1[1]=t[1]*this.Foco1[0]+t[2]*this.Foco1[1]+t[4],this.Dir1[2]=t[3]*this.Foco1[0]+t[4]*this.Foco1[1]+t[5],this.Dir2[0]=t[0]*this.Foco2[0]+t[1]*this.Foco2[1]+t[3],this.Dir2[1]=t[1]*this.Foco2[0]+t[2]*this.Foco2[1]+t[4],this.Dir2[2]=t[3]*this.Foco2[0]+t[4]*this.Foco2[1]+t[5]},Conica.prototype.datosParabola=function(t){var e;this.e=1,this.Dir1[0]=t[9],this.Dir1[1]=t[10],this.Dir1[2]=-(t[6]+t[8])/2,e=t[9]*t[9]+t[10]*t[10],this.Foco1[0]=(t[6]*t[9]+t[7]*t[10]+this.Dir1[2]*t[9])/e,this.Foco1[1]=(t[7]*t[9]+t[8]*t[10]+this.Dir1[2]*t[10])/e,this.EjeMin[0]=t[9],this.EjeMin[1]=t[10],this.EjeMin[2]=(this.Dir1[2]-this.Dir1[0]*this.Foco1[0]-this.Dir1[1]*this.Foco1[1])/2,this.EjeMax[0]=t[10],this.EjeMax[1]=-t[9],this.EjeMax[2]=-this.Foco1[0]*t[10]+this.Foco1[1]*t[9],this.p=Math.abs(this.Foco1[0]*this.Dir1[0]+this.Foco1[1]*this.Dir1[1]+this.Dir1[2])/2,puntoInterseccionRectas(this.V1,this.EjeMax,this.EjeMin),this.p=distancia(this.Foco1,this.V1),this.teta=Math.atan2(this.Foco1[1]-this.V1[1],this.Foco1[0]-this.V1[0]),arreglaRecta(this.Dir1,this.Dir1)},Conica.prototype.dibujaParabola=function(t,e,a,i,o,r,s){for(var n,h=new Array,c=new Array,p=0,u=0;u<pasos;u++)(n=2*o/(1-cos[u]))<1e4&&(h[p]=cambiaX(transfX(n*cos[u]+o,n*sen[u],r,s)+a),c[p]=cambiaY(transfY(n*cos[u]+o,n*sen[u],r,s)+i),p++);dibujaPoligono(t,e,h,c)},Conica.prototype.dibujaHiperbola=function(t,e,a,i,o,r,s,n){var h,c,p=new Array,u=new Array,l=pasos/4+1;h=a,c=i;for(var m=0;m<l;m++)p[m]=cambiaX(transfX(o/cos[m],r*tan[m],s,n)+h),u[m]=cambiaY(transfY(o/cos[m],r*tan[m],s,n)+c);dibujaPoligonoAbierto(t,e,p,u);for(m=0;m<l;m++)p[m]=cambiaX(transfX(-o/cos[m],r*tan[m],s,n)+h),u[m]=cambiaY(transfY(-o/cos[m],r*tan[m],s,n)+c);dibujaPoligonoAbierto(t,e,p,u);for(m=0;m<l;m++)p[m]=cambiaX(transfX(o/cos[m],-r*tan[m],s,n)+h),u[m]=cambiaY(transfY(o/cos[m],-r*tan[m],s,n)+c);dibujaPoligonoAbierto(t,e,p,u);for(m=0;m<l;m++)p[m]=cambiaX(transfX(-o/cos[m],-r*tan[m],s,n)+h),u[m]=cambiaY(transfY(-o/cos[m],-r*tan[m],s,n)+c);dibujaPoligonoAbierto(t,e,p,u)},Conica.prototype.dibujaElipse=function(t,e,a,i,o,r,s,n){var h,c,p=new Array,u=new Array;h=a,c=i;for(var l=0;l<pasos;l++)p[l]=cambiaX(transfX(o*cos[l],r*sen[l],s,n)+h),u[l]=cambiaY(transfY(o*cos[l],r*sen[l],s,n)+c);p[pasos]=p[0],u[pasos]=u[0],dibujaPoligono(t,e,p,u)},Conica.prototype.dibuja=function(){if(this.visible[2]&&(dibujaRectaGeneral(this.color[2],this.ancho[2],this.EjeMax),dibujaRectaGeneral(this.color[2],this.ancho[2],this.EjeMin)),!this.visible[1]||7!=this.tipoConica&&8!=this.tipoConica||pintaCirculo(this.color[1],1,cambiaX(this.CentroX),cambiaY(this.CentroY),3),this.visible[3]&&(pintaCirculo(this.color[3],1,cambiaX(this.Foco1[0]),cambiaY(this.Foco1[1]),3),pintaCirculo(this.color[3],1,cambiaX(this.Foco2[0]),cambiaY(this.Foco2[1]),3)),this.visible[4]&&(dibujaRectaGeneral(this.color[4],this.ancho[4],this.Dir1),dibujaRectaGeneral(this.color[4],this.ancho[4],this.Dir2)),this.visible[5]&&(dibujaRectaGeneral(this.color[5],this.ancho[5],this.Asin1),dibujaRectaGeneral(this.color[5],this.ancho[5],this.Asin2)),7==this.tipoConica?this.dibujaElipse(this.color[0],this.ancho[0],this.CentroX,this.CentroY,Math.abs(this.ejeX),Math.abs(this.ejeY),Math.cos(this.teta),Math.sin(this.teta)):8==this.tipoConica?this.dibujaHiperbola(this.color[0],this.ancho[0],this.CentroX,this.CentroY,Math.abs(this.ejeX),Math.abs(this.ejeY),Math.cos(this.teta),Math.sin(this.teta)):9==this.tipoConica&&this.dibujaParabola(this.color[0],this.ancho[0],this.V1[0],this.V1[1],this.p,Math.cos(this.teta),Math.sin(this.teta)),null!=this.miEtiqueta)switch(this.miEtiqueta.visible){case 0:break;case 2:this.mandaEtiqueta(this.nombre);break;case 1:new Array;var t=escribePolinomio([this.paramDir[0],2*this.paramDir[1],this.paramDir[2],2*this.paramDir[3],2*this.paramDir[4],this.paramDir[5]],["x2","xy","y2","x","y",""]);this.miEtiqueta.ancla>-1&&listaObjetos[this.miEtiqueta.ancla].visible[0]>0&&listaObjetos[this.miEtiqueta.ancla].mandaEtiqueta(t+" = 0")}},Conica.prototype.rellena=function(){},Conica.prototype.mandaEtiqueta=function(t){switch(this.tDibujo){case 0:var e=this.Foco1[0],a=this.Foco1[1];this.ponEtiqueta(t,cambiaX(e)+20,cambiaY(a)+20)}}}function Etiqueta(){new Array}function Nota(){this.paso=new Array;this.frase=new Array,this.pedazo=new Array,this.variable=new Array,this.caracter=new Array,this.var1=new Array,this.arrPolacas=new Array,this.valor=new Array,this.sValor=new Array,Nota.prototype.procesaNota=function(){this.preparaFrases()},Nota.prototype.preparaFrases=function(){var t=!1,e=0,a=0,i=-1,o=0;for(this.numVar=0;a<this.memoria.length;)"$"==this.memoria[a]&&(t=!t)&&this.numVar++,a++;for(a=0;a<this.memoria.length;){if("$"==this.memoria[a]){for(i=a+1;"$"!=this.memoria[i];)i++;this.pedazo[e]=this.memoria.substr(o,a-o),this.var1[e]=this.memoria.substr(a+1,i-a-1);this.pedazo[e];e++,o=i+1,a=i+1}a++}i++,this.pedazo[e]=this.memoria.substr(i,this.memoria.length-i);for(var r=0;r<this.numVar;r++)this.variable[r]=this.var1[r],this.arrPolacas[r]=new TPolaca,this.arrPolacas[r].formula=this.variable[r],this.arrPolacas[r].AnalizaFormula(),this.valor[r]=1*this.arrPolacas[r].Evalua(),this.sValor[r]=this.valor[r].toFixed(ambiente.decimales),this.var1[r]=this.sValor[r]+"";this.reconstruye()},Nota.prototype.reconstruye=function(){if(this.pedazo.length>0){for(var t=this.pedazo[0].length,e=0;e<this.numVar;e++)t=t+this.var1[e].length+this.pedazo[e+1].length;this.nArreglo=this.pedazo[0];for(this.pedazo[0].length,e=0;e<this.numVar;e++)this.nArreglo=this.nArreglo+this.var1[e],this.nArreglo=this.nArreglo+this.pedazo[e+1];this.texto=this.nArreglo}},Nota.prototype.recalcula=function(){for(var t=0;t<this.numVar;t++)this.valor[t]=this.arrPolacas[t].Evalua(),enGrados&&this.arrPolacas[t].esAngulo&&(this.valor[t]=180*this.valor[t]/Math.PI),this.sValor[t]=this.valor[t].toFixed(ambiente.decimales),this.var1[t]=this.sValor[t]+"";this.reconstruye()}}function TFormulas(){TFormulas.prototype.AnalizaFormula=function(){for(var t=0;t<this.arrPolacas.length;t++)this.arrPolacas[t].AnalizaFormula()}}function TPolaca(){this.pila=new Array,TPolaca.prototype.Evalua=function(){var t=0,e=new Array;e[0]=0;var a,i=new Array,o=new Array;try{for(var r=0;r<this.pila.length;r++){this.pila[r].tipo;switch(this.pila[r].tipo){case NEGATIVO:e[t-1]=-e[t-1];break;case MAS:e[t-2]+=e[t-1],t--;break;case MENOS:e[t-2]-=e[t-1],t--;break;case POR:e[t-2]*=e[t-1],t--;break;case ENTRE:e[t-2]/=e[t-1],t--;break;case EXP:if(e[t-1]==Math.floor(e[t-1])){for(var s,n=e[t-1],h=e[t-2],c=Math.abs(n),p=1,u=0;u<c;u++)p*=h;n<0&&0!=p&&(p=1/p),e[t---2]=p}else s=Math.max(Math.pow(e[t-2],e[t-1]),limiteMaximo),e[t---2]=s;break;case VAR:this.pila[r].valor=this.pila[r].ob.parametros[this.pila[r].variable],e[t++]=this.pila[r].valor;break;case OBJ_VAR:o[t++]=this.pila[r].ob;break;case NUM:e[t++]=this.pila[r].valor;break;case FUNC_1:e[t-1]=this.pila[r].funcion_1(e[t-1]);break;case FUNC_n:for(u=0;u<t;u++)i[u]=e[u];e[0]=this.pila[r].funcion_n(i);break;case FUNC_geo:for(u=0;u<t;u++)i[u]=e[u];a=e[t-1]=this.pila[r].funcion_g(o[t-2],o[t-1]),e[--t-1]=a}}return e[0]}catch(t){return 0}},TPolaca.prototype.AnalizaFormula=function(){this.numReg=0;var t=new Token;t.entrada=this.formula,t.tam=t.entrada.length,this.analizador(t)},TPolaca.prototype.analizador=function(t){var e,a,i=new Array,o=0,r=!1;"-"==t.entrada[0]&&(i[o]=new StackOp,i[o].op=NEGATIVO,i[o++].pre=4,t.entrada=recorre(t.entrada,1));do{if(a=t.siguienteOp(),this.esAngulo=t.esAngulo,a<=EXP||a>=COMA){for(e=this.defPrecedencia(a);o>0&&e<=i[o-1].pre;o--)this.pila[this.numReg]=new Elemento,this.pila[this.numReg++].tipo=i[o-1].op;i[o]=new StackOp,i[o].op=a,i[o++].pre=e}switch(a){case NUM:this.pila[this.numReg]=new Elemento,this.pila[this.numReg].valor=t.real,this.pila[this.numReg++].tipo=a;break;case VAR:this.pila[this.numReg]=new Elemento,this.pila[this.numReg].variable=t.cualVar,this.pila[this.numReg].valor=t.pvar,this.pila[this.numReg].ob=t.ob,this.pila[this.numReg].tipo=a,this.numReg++;break;case OBJ_VAR:this.pila[this.numReg]=new Elemento,this.pila[this.numReg].ob=t.ob,this.pila[this.numReg++].tipo=a;break;case FUNC_geo:var s=t.funcion_g;t.esSubVar=!1;for(var n=0;n<=t.num_comas;n++)this.analizador(t);t.esSubVar=!0,this.pila[this.numReg]=new Elemento,this.pila[this.numReg].f_geo=s,this.pila[this.numReg++].tipo=a;break;case FUNC_1:var h=t.funcion;this.analizador(t),this.pila[this.numReg]=new Elemento,this.pila[this.numReg].f_1=h,this.pila[this.numReg++].tipo=a;break;case FUNC_n:var c=t.funcion_n;for(n=0;n<=t.num_comas;n++)this.analizador(t);this.pila[this.numReg]=new Elemento,this.pila[this.numReg].f_n=c,this.pila[this.numReg++].tipo=a;break;case ABREP:this.analizador(t);break;case COMA:r=!0;break;case CIERRAP:case EOLN:case FALSO:r=!0}}while(!r)},TPolaca.prototype.defPrecedencia=function(t){return t<POR?1:t<EXP?2:t<NUM?3:0}}function StackOp(){}function Token(){this.num_comas=1,this.lugarVar=new Array,this.esAngulo=!1,this.ob=null,Token.prototype.siguienteOp=function(){var t;if(0==this.entrada.length)t=EOLN;else{for(;this.entrada.length>0&&(" "==this.entrada[0]||"\n"==this.entrada[0]||"\r"==this.entrada[0]);)this.entrada=recorre(this.entrada,1);if(0==this.entrada.length)t=EOLN;else if(esDigito(this.entrada[0])||"."==this.entrada[0])t=this.esNumero();else if(esLetra(this.entrada[0])&&this.esFuncion()){var e=this.esfuncion_n();if(e==FALSO){var a=this.esfuncion_1();if(a==FALSO){var i=this.esfuncion_geo();if(i==FALSO){var o=this.esfuncion_V();t=o==FALSO?this.esConstante():o}else t=i}else t=a}else t=e}else if(esLetra(this.entrada[0]))t=this.esVariable();else{switch(this.entrada[0]){case"+":t=MAS;break;case"-":t=MENOS;break;case"*":t=POR;break;case"/":t=ENTRE;break;case"^":t=EXP;break;case",":t=COMA;break;case"(":t=ABREP;break;case")":t=CIERRAP;break;default:t=FALSO}this.entrada=recorre(this.entrada,1)}}return t},Token.prototype.esFuncion=function(){if(this.entrada.length>1&&"t_"==this.entrada.substr(0,2))return!1;for(var t=0;t<this.entrada.length&&(esLetra(this.entrada[t])||"("==this.entrada[t]||"_"==this.entrada[t]);){if("("==this.entrada[t]||"_"==this.entrada[t])return!0;t++}return!1},Token.prototype.esVariable=function(){return this.esSubVariable()==VAR?VAR:this.esObjVariable()},Token.prototype.esSubVariable=function(){for(var t,e=0,a=this.entrada;e<this.entrada.length&&(esDigito(this.entrada[e])||esLetra(this.entrada[e]));)e++;for(var i=0;i<listaObjetos.length;i++){var o=a.substr(0,e);if(e==listaObjetos[i].nombre.length&&listaObjetos[i].nombre==o){var r;t=this.entrada,this.entrada=recorre(this.entrada,e),listaObjetos[i].tag=1;var s=i;return(r=this.cualParametro(s))==FALSO&&(this.entrada=t),r}}return FALSO},Token.prototype.cualParametro=function(t){var e,a,i,o=(e=listaObjetos[t]).tipo,r=0;if(a=["x,y,","A,B,C,","a,b,r,","A,B,C,D,E,F,a,b,c,d,e,f,det,","","a,x,y"][[0,1,2,3,4,4,4,4,4,4,5,4,4,4][o]],0==this.entrada.length||"."!=this.entrada[0])return 0==a.length?(this.pvar=e.parametros[0],this.cualVar=0,this.ob=e,e.tipo!=TipoAngulo&&e.tipo!=TipoMedidaAngulo||(this.esAngulo=!0),this.existeVar=!0,VAR):FALSO;i=a.substr(0,a.indexOf(",")),a=a.substr(a.indexOf(",")+1),this.entrada=recorre(this.entrada,1);for(var s=0;s<this.entrada.length&&esLetra(this.entrada[s]);s++);for(;null!=i&&""!=i;){var n=i.length;if(n==s&&i==this.entrada.substr(0,n))return this.entrada=recorre(this.entrada,n),this.pvar=e.parametros[r],this.ob=e,this.cualVar=r,o==TipoAngulo&&(this.esAngulo=!0),this.existeVar=!0,VAR;r++,i=a.substr(0,a.indexOf(",")),a=a.substr(a.indexOf(",")+1)}return FALSO},Token.prototype.esNumero=function(){var t,e,a,i=0,o=this.entrada;for(a=!1;this.entrada.length>0&&(esDigito(this.entrada[0])||"."==this.entrada[0]&&!a);)"."==this.entrada[0]&&(a=!0),this.entrada=recorre(this.entrada,1),i++;if(1==i&&"."==o[0])return FALSO;if(this.entrada.length>0&&"E"==this.entrada[0])for(this.entrada=recorre(this.entrada,1),i++,e=0;esDigito(this.entrada[0])&&++e<=3;)this.entrada=recorre(this.entrada,1),i++;return t=o.substr(0,i),this.real=1*t,NUM},Token.prototype.esObjVariable=function(){for(var t,e=FALSO,a=0,i=this.entrada,o=this.entrada;a<i.length&&(esDigito(i[a])||esLetra(i[a])||"_"==i[a]);)a++;for(var r=0;r<listaObjetos.length;r++){t=listaObjetos[r];var s=o.substr(0,a);if(a==t.nombre.length&&t.nombre==s){this.entrada=recorre(this.entrada,a),t.tag=1,this.pvar=t.parametros[0],this.ob=t,this.numVarObj=t.numParam,this.tGeoVar=t.tipo,e=OBJ_VAR;break}}return 2==a&&"t_"==this.entrada.substr(0,2)?(this.pvar=t.parametros[4],this.cualVar=4,this.ob=objetoActual,this.numVarObj=t.numParam,this.tGeoVar=t.tipo,this.entrada=recorre(this.entrada,2),VAR):e},Token.prototype.esfuncion_1=function(){for(var t=this.ponNombre(),e=0;e<num_fun;e++)if(t==funciones[e])return this.entrada=recorre(this.entrada,t.length+1),this.funcion=e,FUNC_1;return FALSO},Token.prototype.ponNombre=function(){this.entrada.length;for(var t=0;t<this.entrada.length&&("_"==this.entrada[t]||esDigito(this.entrada[t])||esLetra(this.entrada[t]));t++);return this.entrada.substr(0,t)},Token.prototype.esfuncion_n=function(){for(var t=this.ponNombre(),e=0;e<num_FUNC_n;e++)if(t==funciones_n[e])return this.entrada=recorre(this.entrada,t.length+1),this.funcion_n=e,FUNC_n;return FALSO},Token.prototype.esConstante=function(){for(var t=this.ponNombre(),e=0;e<num_const;e++)if(t==constantes[e]){switch(this.entrada=recorre(this.entrada,t.length),this.constante=e,e){case 0:Math.PI;break;case 1:Math.E}return NUM}return FALSO},Token.prototype.esfuncion_geo=function(){for(var t=this.ponNombre(),e=0;e<num_FUNC_geo;e++)if(t==funciones_geo[e])return this.entrada=recorre(this.entrada,t.length+1),this.funcion_g=e,FUNC_geo;return FALSO}}function Elemento(){Elemento.prototype.funcion_1=function(t){var e=0;switch(this.f_1){case 0:e=Math.abs(t);break;case 1:e=Math.acos(t);break;case 2:e=Math.asin(t);break;case 3:e=Math.atan(t);break;case 4:e=Math.cos(t);break;case 5:e=(Math.exp(t)+Math.exp(-t))/2;break;case 6:e=Math.exp(t);break;case 7:e=Math.log(t);break;case 8:e=Math.log(t)/Math.log(10);break;case 9:e=Math.floor(t);break;case 10:e=Math.sin(t);break;case 11:e=(Math.exp(t)-Math.exp(-t))/2;break;case 12:e=Math.sin(t);break;case 13:e=t>0?1:t<0?-1:0;break;case 14:e=(Math.exp(t)-Math.exp(-t))/2;break;case 15:e=Math.sqrt(t);break;case 16:e=Math.tan(t);break;case 17:e=(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}return e},Elemento.prototype.funcion_n=function(t){var e=0;switch(this.f_n){case 0:e=Math.atan2(t[1],t[0]);break;case 1:e=Math.atan2(t[0],t[1]);break;case 2:e=t[0]<t[1]?t[0]:t[1];break;case 3:e=t[0]>t[1]?t[0]:t[1];break;default:mensaje="Funcion de dos variables no implementada: "+this.f_n}return e},Elemento.prototype.funcion_g=function(t,e){var a,i,o,r,s,n=0;switch(this.f_geo){case 0:a=t.parametros[0],i=t.parametros[1],n=hipotenusa(e.parametros[0]-a,e.parametros[1]-i);break;case 1:a=t.parametros[0],i=t.parametros[1],o=e.parametros[0],r=e.parametros[1],s=e.parametros[2],n=Math.abs(o*a+r*i+s);break;default:mensaje="Funcion de dos variables no implementada: "+this.f_geo}return n}}function escribeParametros(){respuesta="",null!=nota&&(respuesta=respuesta+nota.texto+"<br>"),document.getElementById("cuaderno")&&(document.getElementById("cuaderno").innerHTML=respuesta)}function funcionExporta(t){if(null!=t.exporta)try{if(++retardoDescartes>10){for(var e=0;e<t.exporta.length;e++)parent.postMessage({type:"set",name:t.exporta[e],value:t.parametros[e]},"*");parent.postMessage({type:"update"},"*"),retardoDescartes=0}}catch(t){}}function funcionImporta(t){var e,a;if(null!=t.importa&&descartes.length>0)for(var i=0;i<t.importa.length;i++)e=t.importa[i],a=1*descartes[e],t.parametros[i]=a}function recalculaTodo(){for(var t=0;t<listaObjetos.length;t++)eligeConstructor(listaObjetos[t]),funcionImporta(listaObjetos[t]),funcionExporta(listaObjetos[t]);null!=nota&&nota.recalcula(),draw()}function eligeConstructor(t){switch(t.tConstructor){case 0:t.puntoDirecto();break;case 2:t.puntoProyeccionRecta();break;case 1:t.puntoInterseccionRectas();break;case 3:t.puntoMedio();break;case 4:t.puntoDivisionSegmento();break;case 6:t.puntoEnSegmento();break;case 7:t.puntoEnCirculo();break;case 8:t.puntoInterseccionRectaCirculo();break;case 9:t.puntoInterseccionRectaCirculoMismo();break;case 10:t.puntoInterseccionRectaCirculoOpuesto();break;case 11:t.puntoInterseccionCirculosRaton();break;case 12:t.puntoInterseccionCirculosMismoLado();break;case 13:t.puntoInterseccionCirculosOtroLado();break;case 15:t.puntoInterseccionRectaConicaMismo();break;case 16:t.puntoInterseccionRectaConicaOtro();break;case 17:t.puntoPoloCirculo();break;case 18:t.puntoPoloConica();break;case 20:t.puntoAfin();break;case 24:t.puntoCentroConica();break;case 28:t.puntoEnRecta();break;case 29:t.RectaElena();break;case 30:t.RectaDirecta();break;case 31:t.rectaPorDosPuntos();break;case 32:t.rectaParalela();break;case 34:t.rectaPerpendicular();break;case 33:t.rectaMediatriz();break;case 35:t.rectaEjeRadical();break;case 36:t.rectaBisectrizInterior();break;case 37:t.rectaBisectrizExterior();break;case 38:t.segmentoPorDosPuntos();break;case 45:t.rectaTangenteCirculoMismoLado();break;case 46:t.rectaTangenteCirculoOtroLado();break;case 48:t.rectaTangenteConicaMismoLado();break;case 49:t.rectaTangenteConicaOtroLado();break;case 40:t.rectaPolarCirculo();break;case 41:t.rectaPolarConica();break;case 52:t.rectaEjeFocalConica();break;case 53:t.rectaEjeConjugadoConica();break;case 54:t.rectaDirectrizConica();break;case 60:t.circuloDirecto();break;case 61:t.circuloCentroRadio();break;case 62:t.circuloCentroPunto();break;case 63:t.circuloCircuncirculo();break;case 64:t.circuloIncirculo();break;case 65:t.circuloExcirculo();break;case 66:t.circuloTransformado();break;case 73:t.arcoEnCirculo();break;case 80:t.escalarDirecto();break;case 81:t.escalarDistanciaDosPuntos();break;case 82:t.escalarDistanciaPuntoRecta();break;case 83:t.escalarPotencia();break;case 86:t.escalarDivisionSegmento();break;case 87:t.escalarRazonCruzadaPuntos();break;case 88:t.escalarRazonRectas();break;case 89:t.escalarPerimetroPoligono();break;case 90:t.escalarAreaPoligono();break;case 92:t.anguloDirecto();break;case 94:t.anguloAOB();break;case 95:t.anguloConica();break;case 96:t.escalarSemiEjeFocal();break;case 97:t.escalarSemiEjeConjugado();break;case 98:t.escalarSemiDistanciaFocal();break;case 99:t.escalarExcentricidad();break;case 100:t.conicaDirecta();break;case 107:t.parabolaFocoDirectriz();break;case 108:t.parabola4Tangentes();break;case 105:t.ElipseFocosPunto();break;case 106:t.hiperbolaFocosPunto();break;case 104:t.conicaFocosA();break;case 109:t.conicaFocosDirectrizPunto();break;case 103:t.conicaFocoDirectrizExcentricidad();break;case 101:t.conica5Puntos();break;case 102:t.conica5Rectas();break;case 111:t.conicaTransformada();break;case 121:t.transfTranslacion();break;case 122:t.transfRotacion();break;case 123:t.transfReflexion();break;case 125:t.transfHomotecia();break;case 129:t.transfComposicion();case 132:break;case 150:case 151:case 152:case 153:case 154:case 155:case 260:t.objetoCalculado();break;case 200:t.creaPoligono();break;case 205:t.arcoAOB();break;case 214:t.arcoAOB_o();break;case 243:t.condicionOrientado();break;case 280:t.verticePoligonoRegular();break;default:mensaje="No existe el constructor "+t.tConstructor}}function conectaComplejos(t){for(var e=0;e<t.length;e++)t[e].claseCompleja==TC_Polaca&&(objetoActual=t[e],t[e].datoFormula.AnalizaFormula())}function aArreglo(t){for(var e=new Array,a=0;a<t.length;a++)e[a]=t.charAt(a);return e}function aString(t){for(var e="",a=0;a<t.length;a++)e+=t[a];return e}function recorre(t,e){return t.substr(e)}function esDigito(t){var e=t+"";return 0<=e&&e<=9}function esLetra(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"}function calculaRazon(t){Math.abs(t.objRef[0].parametros[0]-t.objRef[1].parametros[0])<epsilon?(t.parametros[4]=t.objRef[0].parametros[1]-t.parametros[1],t.parametros[3]=t.parametros[1]-t.objRef[1].parametros[1]):(t.parametros[4]=t.objRef[0].parametros[0]-t.parametros[0],t.parametros[3]=t.parametros[0]-t.objRef[1].parametros[0])}function escalarDivisionSegmento(t,e,a,i){return 0==e[2]?(t[0]=-1,!0):Math.abs(i[0]-e[0])>epsilon&&(t[0]=(e[0]-a[0])/(i[0]-e[0]),!0)}function escalarPotencia(t,e,a){return t[0]=(e[0]-a[0])*(e[0]-a[0])+(e[1]-a[1])*(e[1]-a[1])-a[2]*a[2],!0}function puntoMedio(t,e,a){return t[0]=(e[0]+a[0])/2,t[1]=(e[1]+a[1])/2,!0}function puntoInterseccionRectas(t,e,a){var i=e[0]*a[1]-e[1]*a[0];return t[0]=a[2]*e[1]-e[2]*a[1],t[1]=e[2]*a[0]-e[0]*a[2],Math.abs(i)<epsilon?(t[2]=0,!1):(t[0]/=i,t[1]/=i,t[2]=1,!0)}function puntoProyeccionRecta(t,e,a){var i=new Array;return rectaPerpendicular(i,a,e),puntoInterseccionRectas(t,a,i)}function puntoInterseccionRectaCirculo(t,e,a,i,o){var r,s,n,h,c,p,u,l=new Array;return!((r=Math.abs(e[0]*a[0]+e[1]*a[1]+e[2]))>a[2])&&(n=Math.sqrt(a[2]*a[2]-r*r),h=-e[1]*a[0]+e[0]*a[1],rectaPerpendicular(l,e,a),s=l[0]*i[0]+l[1]*i[1]+l[2],u=o&&s>0||!o&&s<0?1:-1,c=-e[0]*e[2]-e[1]*h,p=e[0]*h-e[1]*e[2],t[0]=c+u*n*e[1],t[1]=p-u*n*e[0],t[2]=1,!0)}function puntoInterseccionRectaConica(t,e,a,i,o){var r,s=new Array,n=new Array,h=new Array,c=new Array,p=new Array;return!!puntoPoloConica(h,a,e)&&(!!tangentesConica(s,n,e,h)&&(!!puntoInterseccionRectas(p,a,s)&&(p[2]=1,c[0]=e[0]*a[1]-e[1]*a[0],c[1]=e[1]*a[1]-e[2]*a[0],c[2]=e[3]*a[1]-e[4]*a[0],p[2]=1,r=(c[0]*i[0]+c[1]*i[1]+c[2])*(c[0]*p[0]+c[1]*p[1]+p[2]),o&&r>0||!o&&r<0?(t[0]=p[0],t[1]=p[1],!0):!!puntoInterseccionRectas(t,a,n))))}function puntoDivisionSegmento(t,e,a,i){return Math.abs(i[0]+1)<epsilon?(t[2]=0,!1):(t[2]=1,t[0]=(e[0]+i[0]*a[0])/(1+i[0]),t[1]=(e[1]+i[0]*a[1])/(1+i[0]),!0)}function puntoPoloCirculo(t,e,a){var i=new Array;i[0]=a[0]*a[0]-a[2]*a[2],i[1]=a[1]*a[1]-a[2]*a[2],i[2]=a[0]*a[1];var o=e[0]*a[0]+e[1]*a[1]+e[2];return t[0]=i[0]*e[0]+i[2]*e[1]+a[0]*e[2],t[1]=i[2]*e[0]+i[1]*e[1]+a[1]*e[2],Math.abs(o)<epsilon?(t[2]=0,normalizaRecta(t,t)):(t[0]/=o,t[1]/=o,t[2]=1),!0}function puntoPoloConica(t,e,a){var i;return i=e[0]*a[9]+e[1]*a[10]+e[2]*a[11],t[0]=a[6]*e[0]+a[7]*e[1]+a[9]*e[2],t[1]=a[7]*e[0]+a[8]*e[1]+a[10]*e[2],Math.abs(i)<epsilon?(t[2]=0,normalizaRecta(t,t)):(t[0]/=i,t[1]/=i,t[2]=1),!0}function tangentesConica(t,e,a,i){var o,r,s,n,h,c,p;return o=a[0]*i[0]+a[1]*i[1]+a[3],r=a[1]*i[0]+a[2]*i[1]+a[4],s=a[3]*i[0]+a[4]*i[1]+a[5],h=o*o-(n=o*i[0]+r*i[1]+s)*a[0],!((p=(c=o*r-n*a[1])*c-h*(r*r-n*a[2]))<0)&&(t[0]=h,t[1]=c-Math.sqrt(p),t[2]=-t[0]*i[0]-t[1]*i[1],e[0]=h,e[1]=2*c-t[1],e[2]=-e[0]*i[0]-e[1]*i[1],!0)}function arreglaRecta(t,e){return(Math.abs(t[0])>epsilon||Math.abs(t[1])>epsilon)&&(normalizaRecta(t,e),!0)}function normalizaRecta(t,e){var a=hipotenusa(t[0],t[1]);Math.abs(a-1)<epsilon||(e[0]=t[0]/a,e[1]=t[1]/a,e[2]=t[2]/a)}function rectaPorDosPuntos(t,e,a){return this.rectaDosPuntosSinNormalizar(t,e,a),!!arreglaRecta(t,t)}function rectaDosPuntosSinNormalizar(t,e,a){return t[0]=a[1]*e[2]-e[1]*a[2],t[1]=-a[0]*e[2]+e[0]*a[2],t[2]=-e[0]*a[1]+a[0]*e[1],!0}function paralela(t,e,a){return t[0]=e[0],t[1]=e[1],t[2]=-a[0]*e[0]-a[1]*e[1],!!arreglaRecta(t,t)}function rectaPerpendicular(t,e,a){return rectaPerpendicularSinNormalizar(t,e,a),!!arreglaRecta(t,t)}function rectaPerpendicularSinNormalizar(t,e,a){return t[0]=e[1],t[1]=-e[0],t[2]=-a[0]*e[1]+a[1]*e[0],!0}function rectaPolarCirculo(t,e,a){var i;return t[0]=e[0]-a[0],t[1]=e[1]-a[1],(i=hipotenusa(t[0],t[1]))<epsilon?(t[0]=0,t[1]=0,t[2]=1):(t[2]=(-a[0]*t[0]-a[1]*t[1]-a[2]*a[2])/i,t[0]/=i,t[1]/=i),!0}function rectaPolarConica(t,e,a){var i;return t[0]=a[0]*e[0]+a[1]*e[1]+a[3],t[1]=a[1]*e[0]+a[2]*e[1]+a[4],(i=hipotenusa(t[0],t[1]))<epsilon?(t[0]=0,t[1]=0,t[2]=1):(t[0]/=i,t[1]/=i,t[2]=(a[3]*e[0]+a[4]*e[1]+a[5])/i),!0}function rectaTangenteCirculo(t,e,a,i,o){var r=new Array,s=new Array;return!!rectaPolarCirculo(r,a,e)&&(!!puntoInterseccionRectaCirculo(s,r,e,i,o)&&(!!rectaPorDosPuntos(t,a,s)&&(respuesta="Polar: "+r+"<br> P: "+a+"<br> A: "+i+"<br>Mismo: "+o+"<br>Punto: "+s+"<br>Tangente: "+t,!0)))}function rectaTangenteConica(t,e,a,i,o){var r,s=new Array,n=new Array,h=new Array,c=new Array,p=new Array;return!!tangentesConica(s,n,e,a)&&(!!rectaPolarConica(h,a,e)&&(!!puntoInterseccionRectas(c,h,s)&&(p[0]=e[0]*h[1]-e[1]*h[0],p[1]=e[1]*h[1]-e[2]*h[0],p[2]=e[3]*h[1]-e[4]*h[0],r=(p[0]*i[0]+p[1]*i[1]+p[2])*(p[0]*c[0]+p[1]*c[1]+p[2]),o&&r>0||!o&&r<0?(t[0]=s[0],t[1]=s[1],t[2]=s[2]):(t[0]=n[0],t[1]=n[1],t[2]=n[2]),!0)))}function tangentesConica(t,e,a,i){var o,r,s,n,h,c,p;return o=a[0]*i[0]+a[1]*i[1]+a[3]*i[2],r=a[1]*i[0]+a[2]*i[1]+a[4]*i[2],s=a[3]*i[0]+a[4]*i[1]+a[5]*i[2],h=o*o-(n=o*i[0]+r*i[1]+s*i[2])*a[0],!((p=(c=o*r-n*a[1])*c-h*(r*r-n*a[2]))<0)&&(t[0]=h,t[1]=c-Math.sqrt(p),t[2]=-t[0]*i[0]-t[1]*i[1],e[0]=h,e[1]=2*c-t[1],e[2]=-e[0]*i[0]-e[1]*i[1],!0)}function mediatriz(t,e,a){t[0]=e[0]-a[0],t[1]=e[1]-a[1];var i=hipotenusa(t[0],t[1]);return!(Math.abs(i)<epsilon)&&(t[0]/=i,t[1]/=i,t[2]=.5*-(t[0]*(e[0]+a[0])+t[1]*(e[1]+a[1])),!0)}function ejeRadical(t,e,a){return t[0]=2*(e[0]-a[0]),t[1]=2*(e[1]-a[1]),t[2]=-e[0]*e[0]+a[0]*a[0]-e[1]*e[1]+a[1]*a[1]+e[2]*e[2]-a[2]*a[2],!!arreglaRecta(t,t)}function bisectriz(t,e,a,i){var o;return i?(t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2]):(t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2]),o=hipotenusa(t[0],t[1]),!(Math.abs(o)<epsilon)&&(t[0]/=o,t[1]/=o,t[2]/=o,!0)}function signo(t){return t<0?-1:t>0?1:0}function distancia(t,e){return hipotenusa(t[0]-e[0],t[1]-e[1])}function hipotenusa(t,e){return Math.sqrt(t*t+e*e)}function conicaFocos(t,e,a,i){var o=t.parametros;if(Math.abs(i)<epsilon)return!1;var r=(a[0]-e[0])/(2*i),s=(a[1]-e[1])/(2*i),n=(e[0]*e[0]+e[1]*e[1]-a[0]*a[0]-a[1]*a[1])/(4*i)-i;return o[0]=r*r-1,o[1]=r*s,o[2]=s*s-1,o[3]=r*n+a[0],o[4]=s*n+a[1],o[5]=n*n-a[0]*a[0]-a[1]*a[1],completaConica(o),t.describeConica(o),analizaConica(t,t.parametros),t.existe=TE_Existe,t.copiaParametrosDirectos(),!0}function evaluaConica(t,e){return(t[0]*e[0]+t[1]*e[1]+2*t[3])*e[0]+(t[1]*e[0]+t[2]*e[1]+2*t[4])*e[1]+t[5]}function parabola4Tangentes(t,e,a,i,o){var r=new Array,s=new Array,n=new Array,h=new Array,c=new Array,p=new Array;if(!puntoInterseccionRectas(r,e,a))return!1;if(!puntoInterseccionRectas(s,i,o))return!1;if(!puntoInterseccionRectas(n,e,i))return!1;if(!puntoInterseccionRectas(h,o,a))return!1;r[2]=1,s[2]=1,n[2]=1,h[2]=1,conicaDegenerada(c,r,s),conicaDegenerada(p,n,h);for(var u=0;u<6;u++)t.parametros[u+6]=c[5]*p[u]-p[5]*c[u];var l=t.parametros;return completaConicaDual(l),analizaConica(t,l),t.existe=TE_Existe,t.copiaParametrosDirectos(),t.describeConica(l),!0}function conicaDegenerada(t,e,a){t[0]=e[0]*a[0],t[1]=(e[0]*a[1]+e[1]*a[0])/2,t[2]=e[1]*a[1],t[3]=(e[0]*a[2]+e[2]*a[0])/2,t[4]=(e[1]*a[2]+e[2]*a[1])/2,t[5]=e[2]*a[2]}function ConicaFocoDirectriz(t,e,a,i){var o=i*i,r=t.parametros;return r[0]=o*a[0]*a[0]-1,r[1]=o*a[0]*a[1],r[2]=o*a[1]*a[1]-1,r[3]=o*a[0]*a[2]+e[0],r[4]=o*a[1]*a[2]+e[1],r[5]=o*a[2]*a[2]-e[0]*e[0]-e[1]*e[1],completaConica(r),analizaConica(t,t.parametros),t.existe=TE_Existe,t.copiaParametrosDirectos(),t.describeConica(r),!0}function normalizaConica(t){var e=t[0];if(Math.abs(t[2])>Math.abs(e)&&(e=t[2]),Math.abs(e)>epsilon&&1!=e)for(var a=0;a<6;a++)t[a]=t[a]/e;if((e=Math.max(Math.abs(t[0]),Math.abs(t[2])))>epsilon&&1!=e)for(a=0;a<6;a++)t[a]=t[a]/e}function completaConica(t){normalizaConica(t),t[6]=t[2]*t[5]-t[4]*t[4],t[7]=t[3]*t[4]-t[1]*t[5],t[8]=t[0]*t[5]-t[3]*t[3],t[9]=t[1]*t[4]-t[3]*t[2],t[10]=t[1]*t[3]-t[0]*t[4],t[11]=t[0]*t[2]-t[1]*t[1],t[12]=t[0]*t[2]*t[5]-t[0]*t[4]*t[4]-t[1]*t[1]*t[5]+2*t[1]*t[3]*t[4]-t[3]*t[3]*t[2],t[12]=t[0]*t[6]+t[1]*t[7]+t[3]*t[9],Math.abs(t[12])<epsilon&&(t[12]=0)}function completaConicaDual(t){t[0]=t[8]*t[11]-t[10]*t[10],t[1]=t[9]*t[10]-t[7]*t[11],t[2]=t[6]*t[11]-t[9]*t[9],t[3]=t[7]*t[10]-t[9]*t[8],t[4]=t[7]*t[9]-t[6]*t[10],t[5]=t[6]*t[8]-t[7]*t[7],t[12]=t[0]*t[2]*t[5]-t[0]*t[4]*t[4]-t[1]*t[1]*t[5]+2*t[1]*t[3]*t[4]-t[3]*t[3]*t[2],Math.abs(t[12])<epsilon&&(t[12]=0)}function formaPolarizada(t,e,a){var i=new Array,o=0;i[0]=t[0]*a[0]+t[1]*a[1]+t[3]*a[2],i[1]=t[1]*a[0]+t[2]*a[1]+t[4]*a[2],i[2]=t[3]*a[0]+t[4]*a[1]+t[5]*a[2];for(var r=0;r<3;r++)o+=i[r]*e[r];return o}function analizaConica(t,e){t.describeConica(e),t.central?Math.abs(e[1])>epsilon?t.datosConicaCentralGeneral(e):t.datosConicaCentral(e):t.datosParabola(e)}function argumento(t,e){var a=e[0]-t[0],i=e[1]-t[1],o=0;return Math.abs(a)<epsilon&&Math.abs(i)<0?o:((o=Math.atan2(i,a))<0&&(o+=2*Math.PI),o)}function limites(t,e,a,i,o,r,s,n){this.xIzquierda=t,this.yArriba=r,this.xDerecha=e,this.yAbajo=o,this.xMinimo=a,this.xMaximo=i,this.factorX=(e-t)/(i-a);var h=(n+s)/2,c=(r-o)/(2*factorX);this.yMinimo=h+c,this.yMaximo=h-c,this.factorY=-factorX,this.limiteMaximo=cambiaYinv(this.yMaximo)+100,this.limiteMinimo=cambiaYinv(this.yMinimo)-100}function transfX(t,e,a,i){return a*t-i*e}function transfY(t,e,a,i){return i*t+a*e}function cambiaEsc(t){return Math.round(t*factorX)}function cambiaX(t){return Math.round(xIzquierda+(t-xMinimo)*factorX)}function cambiaY(t){return Math.round(yAbajo+(t-yMinimo)*factorY)}function cambiaXinv(t){return xMinimo+(t-xIzquierda)/factorX}function cambiaYinv(t){return yMinimo+(t-yAbajo)/factorY}ObjetoGeometrico.prototype=new ObjetoBasico,MedidaAngulo.prototype=new ObjetoGeometrico,Escalar.prototype=new ObjetoGeometrico,Condicion.prototype=new ObjetoGeometrico,Punto.prototype=new ObjetoGeometrico,Recta.prototype=new ObjetoGeometrico,Angulo.prototype=new ObjetoGeometrico,Grafica.prototype=new ObjetoGeometrico,Circulo.prototype=new ObjetoGeometrico,FuncionRigida.prototype=new ObjetoGeometrico,FuncionSemejanza.prototype=new ObjetoGeometrico,Conica.prototype=new ObjetoGeometrico;var epsilon=1e-8,tfNoFijo=0,tfMovil=1,tfFijo=2,T_no_tipo=-1,TipoPunto=0,TipoRecta=1,TipoCirculo=2,TipoConica=3,TipoEscalar=4,TipoMedidaAngulo=5,TipoFuncionRigida=6,TipoFuncionSemejanza=7,TipoFuncionAfin=8,TipoFuncionProyectiva=9,TipoAngulo=10,TipoAuxiliar=11,TipoPoligono=12,TipoCondicion=13,TipoFuncionInversion=14,TipoFuncionGeneral=15,TipoCurva=16,TipoLugarGeometrico=17,TipoRecursion=18,TipoVarios=19,Tmax_obj=20,tipoObjeto=["Punto","Recta","Circulo","Conica","Escalar","Medida de angulo","Funcion rigida","Funcion semejanza","Funcion afin","Funcion proyectiva","Angulo","Auxiliar","Poligono","Condicion","Inversion","Funcion general","Curva","Lugar geometrico","Recursion","Varios"],UA_Radianes=0,UA_Grados_MS=1,UA_Grados_XX=2,sin_mas=0,con_signo=1,TE_NoExiste=0,TE_Complejo=1,TE_Proyectivo=2,TE_Existe=3,TR_Pasos=0,TR_Compara=1,NumReal=0,NumEntero=1,NumNatural=2,Ninguno=0,Teclado=1,Ambos=2,Calculadora=3,Logico=4,TE_Raton=5,TE_Auxiliar=6,TD_Cartesianas=0,TD_Polares=1,TD_Descripcion=2,TD_Sintetico=3,TC_Simple=0,TC_Polaca=1,TC_Anima=2,TC_Recursion=3,TC_Auxiliar=4,TC_Lugar=5,correcto=0,nulo=1,igual=2,TN_Objeto=0,TN_Condicion=1,TN_Region=2,TE_No=0,TE_Ini=1,TE_Fin=2,TE_Si=3,TT_Rigida=0,TT_Semejanza=1,TT_Afin=2,TT_Proyectiva=3,T_no_Dibujo=-1,DibujoPunto=0,DibujoRecta=1,DibujoSegmento=2,DibujoRayo=3,DibujoCirculo=4,DibujoArco=5,DibujoConica=6,DibujoPoligono=7,DibujoAngulo=8,Tmax_Dibujo=9,NEGATIVO=0,POSITIVO=1,MAS=2,MENOS=3,POR=4,ENTRE=5,EXP=6,OPER=7,NUM=8,VAR=9,OBJ_VAR=10,FUNC_1=11,FUNC_n=12,FUNC_geo=13,ABREP=14,COMA=15,CIERRAP=16,EOLN=17,FALSO=18,num_fun=18,funciones=["abs","acos","asin","atan","cos","cosh","exp","log","log10","maxent","sen","senh","sin","signo","sinh","sqrt","tan","tanh"],num_FUNC_geo=2,funciones_geo=["distP","distR"],num_FUNC_n=4,funciones_n=["arg","atan2","min","max"],num_const=2,constantes=["pi_","e_"],num_FUNC_v=13,funciones_v=["ancho","alto","xmin","xmax","ymin","ymax","xancho","xalto","pixel","Ventanamin","Ventanamax","Ventanamin","Ventanamax"];function Map(t){this.current=void 0,this.size=0,!1===t&&this.disableLinking()}Map.noop=function(){return this},Map.illegal=function(){throw new Error("illegal operation for maps without linking")},Map.from=function(t,e){var a=new Map;for(var i in t)(e||t.hasOwnProperty(i))&&a.put(i,t[i]);return a},Map.prototype.disableLinking=function(){return this.link=Map.noop,this.unlink=Map.noop,this.disableLinking=Map.noop,this.next=Map.illegal,this.key=Map.illegal,this.value=Map.illegal,this.removeAll=Map.illegal,this},Map.prototype.hash=function(t){return typeof t+" "+(t instanceof Object?t.__hash||(t.__hash=++arguments.callee.current):t)},Map.prototype.hash.current=0,Map.prototype.get=function(t){var e=this[this.hash(t)];return void 0===e?void 0:e.value},Map.prototype.put=function(t,e){var a=this.hash(t);if(void 0===this[a]){var i={key:t,value:e};this[a]=i,this.link(i),++this.size}else this[a].value=e;return this},Map.prototype.remove=function(t){var e=this.hash(t),a=this[e];return void 0!==a&&(--this.size,this.unlink(a),delete this[e]),this},Map.prototype.removeAll=function(){for(;this.size;)this.remove(this.key());return this},Map.prototype.link=function(t){0==this.size?(t.prev=t,t.next=t,this.current=t):(t.prev=this.current.prev,t.prev.next=t,t.next=this.current,this.current.prev=t)},Map.prototype.unlink=function(t){0==this.size?this.current=void 0:(t.prev.next=t.next,t.next.prev=t.prev,t===this.current&&(this.current=t.next))},Map.prototype.next=function(){this.current=this.current.next},Map.prototype.key=function(){return this.current.key},Map.prototype.value=function(){return this.current.value};